var geolocs = [[-119.99,34.8224],[-119.993,34.8205],[-119.98,34.8141],[-119.866,34.782],[-119.991,34.8233],[-119.874,34.789],[-119.872,34.787],[-119.946,34.8074],[-119.872,34.7868],[-119.863,34.7784],[-119.891,34.7954],[-119.99,34.818],[-119.991,34.8231],[-119.983,34.8143],[-119.87,34.7837],[-119.865,34.7817],[-119.966,34.814],[-119.966,34.814],[-119.869,34.7837],[-119.981,34.814],[-119.873,34.7888],[-119.96,34.8111],[-119.99,34.8219],[-119.992,34.8252],[-119.99,34.8218],[-119.865,34.7811],[-119.991,34.8214],[-119.957,34.8105],[-119.907,34.7989],[-119.864,34.7807],[-119.873,34.7861],[-119.907,34.7983],[-119.866,34.782],[-119.868,34.7835],[-119.99,34.8219],[-119.894,34.7961],[-119.989,34.8169],[-119.983,34.8144],[-119.942,34.8068],[-119.873,34.7887],[-119.919,34.8008],[-119.935,34.8058],[-119.981,34.8142],[-119.987,34.8166],[-119.994,34.825],[-119.865,34.7817],[-119.872,34.7864],[-119.867,34.7825],[-119.99,34.8218],[-119.942,34.8069],[-119.936,34.8059],[-119.904,34.798],[-119.895,34.7966],[-119.891,34.7952],[-119.958,34.8104],[-119.871,34.7848],[-119.99,34.8217],[-119.953,34.8088],[-119.99,34.8225],[-119.991,34.8191],[-119.937,34.806],[-119.865,34.7811],[-119.865,34.7811],[-119.872,34.787],[-119.989,34.8219],[-119.874,34.7889],[-119.992,34.8197],[-119.907,34.7983],[-119.873,34.7882],[-119.99,34.8218],[-119.864,34.7805],[-119.907,34.7989],[-119.991,34.8233],[-119.962,34.8125],[-119.872,34.7869],[-119.98,34.814],[-119.99,34.8222],[-119.888,34.7946],[-119.952,34.8085],[-119.891,34.7952],[-119.993,34.8208],[-119.992,34.8197],[-119.865,34.7814],[-119.99,34.8217],[-119.888,34.7946],[-119.991,34.8231],[-119.992,34.8238],[-119.992,34.8204],[-119.872,34.7873],[-119.885,34.7932],[-119.991,34.819],[-119.992,34.8204],[-119.882,34.7929],[-119.865,34.7811],[-119.963,34.8126],[-119.864,34.7801],[-119.98,34.8141],[-119.99,34.823],[-119.91,34.7998],[-119.864,34.7796],[-119.992,34.8204],[-119.985,34.8152],[-119.869,34.7835]];
var species = [1705,2231,1835,2276,1621,1955,2531,1698,2584,1999,1707,1600,1671,1678,2162,2118,2120,2121,2266,2277,1752,2080,2165,2168,2171,2074,1913,2660,1898,2444,1963,2336,2320,1670,2026,1649,1650,1967,2350,1722,2087,2088,2142,1972,2177,1890,1851,2011,2012,1730,1731,1667,2280,2353,1793,2013,2016,1756,2040,2404,2151,2191,2193,1996,2041,1775,2037,2329,2526,1617,1618,1917,1622,1979,1987,1990,1991,2182,2455,2285,2254,2257,2258,2259,2260,1822,2368,2036,1880,1882,1883,1885,1843,1696,2447,1607,1953,1869,1829,2373,2188,1683,1833];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});