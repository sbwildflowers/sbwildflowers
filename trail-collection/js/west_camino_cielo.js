var geolocs = [[-119.871,34.5073],[-119.932,34.5273],[-119.964,34.5252],[-119.841,34.5007],[-119.997,34.5303],[-119.892,34.5163],[-119.864,34.5022],[-119.945,34.5295],[-119.87,34.5075],[-119.897,34.5191],[-119.978,34.5255],[-119.837,34.5007],[-119.865,34.5066],[-120.059,34.5332],[-119.849,34.5014],[-119.959,34.5229],[-120.012,34.5301],[-119.82,34.5033],[-119.866,34.5057],[-120.048,34.5364],[-119.947,34.5269],[-119.869,34.508],[-119.853,34.5026],[-120.048,34.5365],[-119.901,34.5203],[-119.87,34.5074],[-119.998,34.5299],[-120.025,34.5334],[-119.905,34.5199],[-119.852,34.5027],[-119.84,34.5009],[-120.034,34.5334],[-119.875,34.5082],[-119.947,34.5281],[-119.815,34.5047],[-120.058,34.5351],[-120.028,34.5332],[-119.872,34.507],[-119.898,34.5191],[-120.005,34.5276],[-119.952,34.5264],[-120.007,34.5279],[-119.83,34.5025],[-119.884,34.5123],[-119.958,34.5229],[-119.838,34.5007],[-119.838,34.5007],[-119.893,34.5166],[-120.039,34.5327],[-120.002,34.5287],[-119.926,34.5242],[-119.924,34.5246],[-119.947,34.5294],[-120.055,34.534],[-119.863,34.5011],[-119.898,34.5196],[-120.058,34.5353],[-119.94,34.5266],[-119.86,34.5007],[-119.841,34.5008],[-119.865,34.5047],[-119.947,34.5281],[-119.905,34.5198],[-119.921,34.5252],[-119.83,34.5025],[-120.034,34.5311],[-119.89,34.5155],[-120.028,34.5335],[-119.964,34.5252],[-119.841,34.5007],[-120.006,34.5278],[-120.059,34.5337],[-120.044,34.5353],[-119.947,34.5307],[-119.817,34.5044],[-120.055,34.534],[-119.899,34.5208],[-119.869,34.508],[-120.006,34.5278],[-119.954,34.5261],[-119.865,34.5048],[-119.945,34.5287],[-119.934,34.5271],[-119.945,34.5287],[-119.866,34.5039],[-119.945,34.5281],[-120.006,34.5278],[-119.87,34.5074],[-119.871,34.5057],[-119.857,34.5021],[-119.99,34.5304],[-119.945,34.5275],[-119.862,34.501],[-120.034,34.5323],[-119.873,34.5077],[-119.903,34.5205],[-120.034,34.5298],[-120.062,34.5336],[-119.907,34.52],[-120.057,34.5354],[-119.936,34.5273],[-119.853,34.5026],[-120.059,34.5334],[-119.947,34.5286],[-120.021,34.5323],[-119.864,34.5022],[-119.946,34.5307],[-120.04,34.5336],[-120.032,34.5339],[-119.891,34.5163],[-120.012,34.5302],[-119.945,34.5282],[-120.021,34.5323],[-120.006,34.5278],[-119.948,34.5266],[-119.85,34.5013],[-120.021,34.5323],[-119.869,34.5079],[-119.859,34.5009],[-120.057,34.5353],[-119.865,34.5049],[-119.995,34.531],[-119.865,34.5027],[-119.935,34.5272],[-119.949,34.5272],[-119.869,34.5079],[-119.812,34.5044],[-119.944,34.5273],[-119.839,34.5005],[-119.915,34.5203],[-119.856,34.5022],[-119.898,34.5192],[-119.954,34.5258],[-119.996,34.5307],[-120.052,34.5357],[-119.953,34.5265],[-119.898,34.5189],[-119.919,34.5237],[-119.901,34.5207],[-119.935,34.5272],[-119.912,34.5209],[-119.866,34.5034],[-119.892,34.5163],[-119.897,34.5187],[-119.945,34.5274],[-120.048,34.5364],[-120.002,34.5283],[-120.04,34.5335],[-119.89,34.5157],[-119.865,34.5062],[-119.868,34.5078],[-119.899,34.5206],[-119.825,34.5033],[-119.893,34.5174],[-120.056,34.5347],[-119.945,34.5309],[-120.034,34.5299],[-120.062,34.5336],[-120.037,34.5307],[-120.028,34.5332],[-120.055,34.5341],[-119.945,34.5297],[-119.945,34.5279],[-119.945,34.5282],[-119.82,34.5033],[-120.056,34.5344],[-119.87,34.5073],[-119.945,34.5277],[-119.945,34.5281],[-120.055,34.5339],[-120.062,34.5336],[-119.932,34.527],[-119.841,34.5008],[-119.99,34.5304],[-119.889,34.5153],[-120.023,34.5339],[-119.817,34.5044],[-119.831,34.5022],[-119.873,34.5077],[-120.034,34.5297],[-119.915,34.5203],[-119.841,34.5007],[-119.889,34.5148],[-119.945,34.5296],[-119.836,34.5007],[-119.889,34.5145],[-120.059,34.5332],[-119.964,34.5255],[-119.934,34.5269],[-119.995,34.5309],[-119.945,34.5281],[-120.058,34.5352],[-120.014,34.5318],[-119.919,34.5236],[-120.036,34.5304],[-119.836,34.5007],[-119.947,34.5299],[-120.034,34.5311],[-120.016,34.5324],[-120.033,34.534],[-120.046,34.5357],[-120.016,34.5325],[-119.945,34.5296],[-119.997,34.5304],[-119.896,34.5176],[-120.002,34.5283],[-119.92,34.5241],[-120.055,34.534],[-119.92,34.5236],[-119.832,34.5005],[-119.99,34.5305],[-120.059,34.534],[-119.842,34.5006],[-119.95,34.5271],[-119.902,34.5206],[-120.058,34.5345],[-119.903,34.5204],[-120.048,34.5364],[-119.945,34.5298],[-120.018,34.533],[-119.95,34.5271],[-119.841,34.5008],[-119.87,34.5075],[-119.945,34.5285],[-120.004,34.5279],[-119.871,34.5053],[-119.843,34.5002],[-119.866,34.507],[-119.948,34.527],[-119.946,34.5307],[-119.955,34.5254],[-119.998,34.5299],[-119.902,34.5203],[-120.058,34.5351],[-119.945,34.5279],[-120.059,34.5332],[-119.897,34.5193],[-119.964,34.5252],[-119.997,34.5303],[-119.813,34.5044],[-119.871,34.5073],[-120.032,34.534],[-119.947,34.5298],[-119.945,34.5276],[-119.819,34.5052],[-119.867,34.5075],[-119.814,34.5045],[-120.062,34.5336],[-119.965,34.5255]];
var species = [2189,2231,2276,1804,2005,1955,2386,1910,1997,1998,1999,2002,1707,1640,1715,1716,1759,2069,2413,1674,1933,2162,2118,1896,2438,2266,2269,2270,2271,2272,2277,1808,2074,2332,1898,1718,2294,1963,2334,2320,1670,1902,2026,2278,1610,2322,1649,1650,2173,1719,1726,1970,2087,2088,1772,2141,2142,1972,2364,1691,2273,1681,1857,1860,1861,1863,1850,1851,1731,2147,1667,2280,1733,1811,2125,2281,1735,1915,1814,1782,2198,1872,1755,1682,2040,1845,2211,2404,1780,1817,2183,2191,2193,1866,2242,2244,2041,1876,2396,1689,2524,2365,1617,1618,1622,1976,1980,1982,1983,1985,1986,1991,2181,2241,2355,1612,2285,1749,1750,2103,2254,2255,2260,1822,2337,2274,2275,2185,2186,2034,2036,2289,1877,1883,1885,1843,1695,2394,1794,1795,2154,2062,1952,1953,1742,1826,1829,2027,2681,1605,1703,2135,2188,1683,1888,2339,1833,1788,2203,1855,2366,2595];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});