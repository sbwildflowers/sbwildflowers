var geolocs = [[-119.632,34.5074],[-119.632,34.5071],[-119.664,34.5234],[-119.635,34.5111],[-119.635,34.5109],[-119.634,34.5101],[-119.647,34.5178],[-119.651,34.5196],[-119.63,34.5107],[-119.632,34.5081],[-119.641,34.5135],[-119.645,34.5148],[-119.656,34.5249],[-119.633,34.506],[-119.633,34.506],[-119.645,34.5147],[-119.631,34.5089],[-119.635,34.511],[-119.633,34.5057],[-119.657,34.5247],[-119.648,34.517],[-119.64,34.5134],[-119.63,34.5115],[-119.645,34.5156],[-119.638,34.5102],[-119.634,34.5041],[-119.631,34.5097],[-119.637,34.51],[-119.635,34.511],[-119.635,34.5111],[-119.634,34.5044],[-119.653,34.5201],[-119.657,34.5235],[-119.631,34.5085],[-119.642,34.5136],[-119.64,34.513],[-119.656,34.5242],[-119.638,34.51],[-119.632,34.5072],[-119.65,34.5189],[-119.653,34.52],[-119.63,34.511],[-119.651,34.5196],[-119.653,34.5217],[-119.657,34.5238],[-119.633,34.5063],[-119.643,34.514],[-119.657,34.5235],[-119.633,34.5062],[-119.631,34.5101],[-119.645,34.5145],[-119.646,34.5162],[-119.644,34.5159],[-119.634,34.5041],[-119.634,34.504],[-119.647,34.5165],[-119.65,34.5185],[-119.642,34.5136],[-119.631,34.5089],[-119.645,34.5156],[-119.648,34.5181],[-119.657,34.525],[-119.657,34.525],[-119.634,34.504],[-119.63,34.5121],[-119.663,34.4655],[-119.633,34.5096],[-119.632,34.5072],[-119.635,34.5111],[-119.64,34.5136],[-119.632,34.5073],[-119.645,34.5158],[-119.642,34.5142],[-119.632,34.5079],[-119.633,34.5097],[-119.658,34.5244],[-119.632,34.5081],[-119.651,34.5196],[-119.63,34.5108],[-119.655,34.5238],[-119.633,34.5065],[-119.634,34.5056],[-119.636,34.5025],[-119.655,34.5236],[-119.632,34.5071],[-119.646,34.5148],[-119.65,34.519],[-119.633,34.5063],[-119.63,34.5122],[-119.632,34.5074],[-119.653,34.5199],[-119.633,34.509],[-119.658,34.5247],[-119.635,34.5033],[-119.64,34.5132],[-119.632,34.5071],[-119.642,34.5141],[-119.64,34.5136],[-119.639,34.5127],[-119.645,34.5148],[-119.634,34.5101],[-119.63,34.5114],[-119.645,34.5157],[-119.654,34.5223],[-119.646,34.5151],[-119.632,34.5086],[-119.631,34.5089],[-119.632,34.5078],[-119.655,34.5253],[-119.644,34.5145],[-119.64,34.5133],[-119.644,34.5145],[-119.632,34.5071],[-119.657,34.5252],[-119.634,34.504],[-119.645,34.5149],[-119.645,34.5147],[-119.631,34.5097],[-119.637,34.51],[-119.631,34.5099],[-119.638,34.51],[-119.63,34.511],[-119.647,34.5165],[-119.632,34.507],[-119.641,34.5135],[-119.645,34.5157],[-119.638,34.5101],[-119.656,34.5247],[-119.634,34.5048],[-119.647,34.5165],[-119.655,34.5241],[-119.634,34.5045],[-119.634,34.5101],[-119.645,34.5159],[-119.63,34.511],[-119.64,34.5136],[-119.642,34.5142],[-119.645,34.5149],[-119.634,34.5041],[-119.63,34.5113],[-119.634,34.5041],[-119.636,34.511],[-119.632,34.5072],[-119.656,34.5249],[-119.636,34.5113],[-119.631,34.5098],[-119.633,34.5074],[-119.634,34.511],[-119.634,34.51],[-119.632,34.5081],[-119.634,34.5041],[-119.645,34.5149],[-119.631,34.5103],[-119.634,34.504],[-119.652,34.5195],[-119.657,34.5236],[-119.639,34.5125],[-119.653,34.52],[-119.633,34.5063],[-119.63,34.5106],[-119.635,34.511],[-119.645,34.5149],[-119.634,34.5048],[-119.631,34.5098],[-119.64,34.5135],[-119.648,34.5169],[-119.656,34.5241],[-119.634,34.5109],[-119.645,34.5155],[-119.656,34.5247],[-119.631,34.5087],[-119.63,34.5107],[-119.646,34.5159],[-119.651,34.52],[-119.63,34.5113],[-119.642,34.5139],[-119.632,34.5081],[-119.631,34.5085],[-119.629,34.5122],[-119.634,34.5041],[-119.632,34.5081],[-119.655,34.5247],[-119.645,34.5148],[-119.634,34.5041],[-119.633,34.5062],[-119.634,34.5048],[-119.63,34.5108],[-119.642,34.5141],[-119.65,34.5185],[-119.658,34.525],[-119.635,34.5034],[-119.633,34.5074],[-119.635,34.511],[-119.635,34.5032],[-119.63,34.5113],[-119.632,34.5086],[-119.635,34.5034],[-119.635,34.5109],[-119.635,34.511],[-119.634,34.5106],[-119.655,34.5241],[-119.657,34.5254],[-119.634,34.5045],[-119.656,34.5235],[-119.655,34.5244],[-119.657,34.5235],[-119.652,34.5195],[-119.645,34.5156],[-119.657,34.524],[-119.632,34.5075],[-119.657,34.5235],[-119.63,34.5117],[-119.642,34.5138],[-119.648,34.5178],[-119.634,34.5102],[-119.629,34.5121],[-119.63,34.5113],[-119.633,34.5087],[-119.634,34.5102],[-119.658,34.5238],[-119.633,34.5093],[-119.64,34.5136],[-119.644,34.5145],[-119.637,34.5106],[-119.634,34.5043],[-119.642,34.5138],[-119.631,34.5098],[-119.63,34.5114],[-119.646,34.5161],[-119.633,34.507],[-119.633,34.5062],[-119.634,34.5048],[-119.644,34.5146],[-119.636,34.5109],[-119.635,34.5027],[-119.639,34.5127],[-119.632,34.5079],[-119.64,34.5135],[-119.64,34.5135],[-119.635,34.5109],[-119.64,34.5135],[-119.632,34.5077],[-119.655,34.5216],[-119.642,34.5138],[-119.644,34.5146],[-119.651,34.5198],[-119.632,34.5073],[-119.633,34.5091],[-119.64,34.5129],[-119.631,34.5089],[-119.645,34.515],[-119.653,34.5202],[-119.639,34.5109],[-119.653,34.52],[-119.655,34.5239],[-119.635,34.5025],[-119.639,34.5111],[-119.63,34.5117],[-119.654,34.5219],[-119.654,34.5219],[-119.634,34.5099],[-119.634,34.5041],[-119.634,34.5041],[-119.64,34.5136],[-119.634,34.5108],[-119.646,34.515],[-119.63,34.5115],[-119.636,34.511],[-119.635,34.511],[-119.645,34.5155],[-119.629,34.5122],[-119.654,34.5219],[-119.635,34.511],[-119.634,34.5046],[-119.634,34.5041],[-119.633,34.5063],[-119.656,34.5248],[-119.631,34.5098],[-119.655,34.5238],[-119.646,34.5162],[-119.632,34.5078],[-119.635,34.5041],[-119.646,34.5162],[-119.634,34.5041],[-119.656,34.5242],[-119.632,34.5081],[-119.63,34.5114],[-119.63,34.5117],[-119.656,34.5253],[-119.633,34.5098],[-119.633,34.5062],[-119.633,34.5065],[-119.632,34.5079],[-119.651,34.5196],[-119.651,34.5193],[-119.65,34.519],[-119.643,34.5138],[-119.645,34.515],[-119.642,34.5142],[-119.632,34.5073],[-119.632,34.5073],[-119.632,34.5074],[-119.646,34.5149],[-119.645,34.5156],[-119.632,34.5084],[-119.651,34.52],[-119.643,34.5143],[-119.649,34.5185],[-119.632,34.508],[-119.632,34.5081],[-119.637,34.5101],[-119.657,34.5236],[-119.651,34.5196],[-119.632,34.5071],[-119.655,34.5239],[-119.64,34.5135],[-119.657,34.524],[-119.637,34.51],[-119.634,34.5041],[-119.651,34.52],[-119.658,34.5238],[-119.654,34.5222],[-119.633,34.5095],[-119.63,34.5121],[-119.633,34.5063],[-119.63,34.512],[-119.63,34.5122],[-119.632,34.5079],[-119.63,34.5114],[-119.656,34.5231],[-119.634,34.51],[-119.654,34.5221],[-119.648,34.5168],[-119.656,34.5241],[-119.658,34.5251],[-119.642,34.5135],[-119.634,34.5048],[-119.634,34.51],[-119.635,34.511],[-119.642,34.514],[-119.647,34.517],[-119.649,34.5186],[-119.631,34.5106],[-119.632,34.5065],[-119.632,34.5074],[-119.645,34.5156],[-119.632,34.5072],[-119.633,34.5074],[-119.63,34.5122],[-119.635,34.511],[-119.64,34.5134],[-119.645,34.5148],[-119.64,34.5131],[-119.64,34.5128],[-119.635,34.5028],[-119.645,34.5159],[-119.634,34.5044],[-119.642,34.5142],[-119.629,34.512],[-119.642,34.5135],[-119.633,34.5063],[-119.651,34.5196],[-119.632,34.5087],[-119.634,34.5109],[-119.653,34.5198],[-119.64,34.5129],[-119.631,34.5084],[-119.633,34.5063],[-119.63,34.5121],[-119.63,34.5122],[-119.656,34.5253],[-119.633,34.5063],[-119.63,34.5113],[-119.65,34.5186],[-119.638,34.5102]];
var species = [2189,1781,2229,2230,2231,2233,2234,1835,2406,2510,2276,1620,1621,2459,1804,1762,1955,1836,2568,2531,1698,2584,1999,1707,1708,1600,1601,1602,2205,2208,1640,1715,1716,1717,1582,1668,2588,2659,2113,1759,1760,1643,1597,1596,2569,2069,2413,2506,1671,1673,1674,1679,1933,1937,2160,2162,2163,2378,2117,2118,2119,1796,1892,1895,1897,2121,2265,2266,2271,2272,1802,1803,2277,1752,2513,2514,2515,1799,2165,2166,2168,2169,2170,2171,2071,2073,2074,2332,2333,2522,1913,1718,2444,2458,1959,1963,1942,2509,2194,1700,1786,2334,2335,2336,2320,1670,1902,1903,1904,2278,1610,2029,1649,1651,1967,2172,2173,2175,1608,1726,1968,2083,2087,2088,2093,1772,2142,2493,1905,1906,2323,1972,2516,1727,2364,2628,2273,1890,1681,1857,1858,1859,1860,1861,1863,1851,1730,1731,2302,1667,2280,2125,1812,2726,1638,1914,1915,1916,1814,1782,2602,2606,2198,2539,2016,1755,1682,2040,1842,1746,1701,1845,2219,2222,2223,2224,2227,2228,2404,1778,1779,1780,1816,1817,2183,2191,2193,2242,2244,2245,1995,2041,1820,2466,2557,2518,2489,2396,2037,2524,2365,1617,1919,1622,1977,1980,1983,1986,1989,1990,1656,1991,2182,1922,2303,2285,1749,1750,1839,2405,2254,2257,2259,2260,1822,2275,2185,2186,2033,2034,1740,2288,2290,2108,1877,1880,1882,1883,1843,1696,2447,1794,1795,1953,1869,1826,1829,2111,1703,2470,2135,1694,2188,1888,2247,2248,1659,2339,1833,2403,2520,1931,1925,1840,2367,2595,2529];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});