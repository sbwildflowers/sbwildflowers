var geolocs = [[-119.266,34.476],[-119.284,34.4772],[-119.259,34.4739],[-119.29,34.4785],[-119.261,34.4753],[-119.289,34.4789],[-119.258,34.4738],[-119.277,34.4748],[-119.287,34.4781],[-119.263,34.4756],[-119.286,34.4776],[-119.269,34.4748],[-119.272,34.4741],[-119.29,34.4782],[-119.259,34.4737],[-119.273,34.4735],[-119.281,34.4758],[-119.27,34.4748],[-119.279,34.4759],[-119.273,34.4733],[-119.287,34.4779],[-119.258,34.4737],[-119.279,34.4759],[-119.287,34.4779],[-119.27,34.4748],[-119.259,34.4738],[-119.289,34.4788],[-119.281,34.4758],[-119.27,34.4748],[-119.285,34.4775],[-119.285,34.4773],[-119.258,34.4737],[-119.291,34.4789],[-119.267,34.476],[-119.272,34.4749],[-119.274,34.4712],[-119.282,34.4759],[-119.274,34.4717],[-119.285,34.4776],[-119.267,34.4761],[-119.272,34.4749],[-119.29,34.4786],[-119.285,34.4776],[-119.258,34.4737],[-119.289,34.4786],[-119.259,34.4742],[-119.278,34.4756],[-119.287,34.4783],[-119.273,34.4731],[-119.285,34.4775],[-119.287,34.4783],[-119.275,34.4704],[-119.272,34.4749],[-119.289,34.4783],[-119.283,34.4764],[-119.271,34.4741],[-119.291,34.4787],[-119.261,34.4753],[-119.27,34.4748],[-119.273,34.4733],[-119.289,34.4786],[-119.29,34.4784],[-119.284,34.4769],[-119.259,34.4742],[-119.288,34.4783],[-119.278,34.4757],[-119.273,34.4737],[-119.289,34.4781],[-119.276,34.4755],[-119.273,34.4735],[-119.271,34.4748],[-119.266,34.476],[-119.272,34.4749],[-119.274,34.4718],[-119.29,34.4785],[-119.275,34.471],[-119.291,34.4785],[-119.286,34.4777],[-119.29,34.4785],[-119.285,34.4775],[-119.29,34.4787],[-119.283,34.4764],[-119.289,34.4786],[-119.286,34.4776],[-119.276,34.475],[-119.27,34.4742],[-119.275,34.475],[-119.268,34.4757],[-119.28,34.4757],[-119.275,34.4707],[-119.278,34.4755],[-119.272,34.474],[-119.27,34.4748],[-119.29,34.4784],[-119.268,34.4757],[-119.27,34.4749],[-119.29,34.4785],[-119.285,34.4774],[-119.287,34.4777],[-119.261,34.4751],[-119.288,34.4783],[-119.29,34.4784],[-119.258,34.4737],[-119.288,34.4783],[-119.268,34.4748],[-119.267,34.476],[-119.281,34.4758],[-119.267,34.476],[-119.276,34.4751],[-119.258,34.4738],[-119.271,34.4748],[-119.273,34.473],[-119.273,34.4747],[-119.275,34.4707],[-119.27,34.4748],[-119.258,34.4737],[-119.285,34.4773],[-119.281,34.4755],[-119.286,34.4774],[-119.29,34.4785],[-119.273,34.4747],[-119.289,34.4782],[-119.289,34.4781],[-119.286,34.4776],[-119.289,34.4784],[-119.291,34.4788],[-119.258,34.4739],[-119.283,34.4763],[-119.281,34.4755],[-119.285,34.4775],[-119.273,34.4728],[-119.271,34.4743],[-119.27,34.4748],[-119.29,34.4786],[-119.284,34.4769],[-119.258,34.4738],[-119.291,34.4788],[-119.265,34.476],[-119.283,34.4769],[-119.285,34.4774],[-119.264,34.4757],[-119.27,34.4748],[-119.284,34.477],[-119.287,34.478],[-119.274,34.4746],[-119.287,34.4779],[-119.287,34.4779],[-119.271,34.4748],[-119.285,34.4774],[-119.273,34.4728],[-119.258,34.4738],[-119.27,34.4748],[-119.269,34.4747],[-119.27,34.4748],[-119.285,34.4774],[-119.289,34.4788],[-119.287,34.4778],[-119.287,34.4779],[-119.285,34.4774],[-119.289,34.4784],[-119.29,34.4786],[-119.284,34.4771],[-119.291,34.4787],[-119.271,34.4748],[-119.266,34.4762],[-119.283,34.4766],[-119.289,34.4787],[-119.281,34.4758],[-119.285,34.4773],[-119.272,34.474],[-119.286,34.4781],[-119.29,34.4787],[-119.29,34.4786],[-119.269,34.4748],[-119.283,34.4764]];
var species = [1705,2231,1835,2276,1621,1804,2195,2025,1706,1707,1708,2208,1640,1715,1716,1717,1668,2113,1759,1643,2643,1672,1937,2272,1802,1803,2277,1666,2165,2169,2171,2074,2332,1913,1718,1700,1786,2335,1670,1902,1610,2029,2030,2448,1649,1766,2173,1968,2087,2088,1772,2141,2142,2158,1972,2516,1691,1890,1858,1859,1863,2143,1731,1769,1667,2280,2125,2262,1915,1814,2198,1793,2016,1746,1844,1845,2211,1779,1780,2151,1817,2183,2192,1866,1713,2242,1654,2244,2022,2023,1947,2396,2037,1617,1919,1622,1979,1983,1657,2446,2241,1922,2317,2503,1612,2285,1749,1839,2254,2255,1822,2275,2034,2036,1877,1882,1883,1843,1696,2447,2062,2133,1684,1953,1823,1869,1826,1829,1846,1694,2188,2250,2339,1833,1834,1788,1931];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});