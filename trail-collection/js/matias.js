var geolocs = [[-119.694,34.4988],[-119.694,34.5035],[-119.748,34.5242],[-119.749,34.5244],[-119.696,34.5099],[-119.698,34.501],[-119.699,34.5132],[-119.743,34.5225],[-119.696,34.5006],[-119.697,34.5115],[-119.748,34.524],[-119.744,34.5236],[-119.695,34.5082],[-119.694,34.5074],[-119.696,34.5007],[-119.696,34.5007],[-119.743,34.5224],[-119.724,34.5249],[-119.743,34.5223],[-119.743,34.5225],[-119.724,34.524],[-119.694,34.5002],[-119.749,34.5248],[-119.695,34.5075],[-119.692,34.5063],[-119.745,34.5234],[-119.745,34.5237],[-119.723,34.5226],[-119.747,34.523],[-119.695,34.5083],[-119.748,34.5239],[-119.746,34.5232],[-119.743,34.5225],[-119.698,34.5004],[-119.692,34.5061],[-119.749,34.5247],[-119.746,34.5232],[-119.749,34.5242],[-119.724,34.524],[-119.693,34.5051],[-119.723,34.522],[-119.695,34.508],[-119.742,34.5228],[-119.701,34.5143],[-119.7,34.5134],[-119.694,34.5072],[-119.732,34.5207],[-119.743,34.5225],[-119.694,34.5009],[-119.697,34.5004],[-119.699,34.5129],[-119.692,34.5063],[-119.702,34.5147],[-119.694,34.5001],[-119.744,34.5225],[-119.696,34.5095],[-119.726,34.5324],[-119.693,34.5052],[-119.749,34.5245],[-119.748,34.5236],[-119.695,34.5078],[-119.739,34.5223],[-119.742,34.5226],[-119.742,34.5224],[-119.695,34.5075],[-119.723,34.5219],[-119.723,34.5213],[-119.749,34.5242],[-119.691,34.506],[-119.692,34.5048],[-119.723,34.5234],[-119.725,34.5224],[-119.748,34.5239],[-119.745,34.5237],[-119.749,34.5242],[-119.695,34.5076],[-119.726,34.5324],[-119.693,34.5064],[-119.698,34.5127],[-119.699,34.5132],[-119.742,34.5224],[-119.695,34.5004],[-119.694,34.5033],[-119.715,34.5182],[-119.698,34.5004],[-119.698,34.4993],[-119.697,34.5107],[-119.698,34.5126],[-119.745,34.5237],[-119.714,34.5186],[-119.709,34.5181],[-119.722,34.5224],[-119.73,34.5216],[-119.695,34.508],[-119.694,34.5006],[-119.749,34.5247],[-119.745,34.5237],[-119.748,34.5232],[-119.732,34.5209],[-119.745,34.5234],[-119.745,34.5237],[-119.699,34.5127],[-119.698,34.5006],[-119.739,34.5223],[-119.694,34.5074],[-119.745,34.5237],[-119.73,34.5218],[-119.698,34.5124],[-119.702,34.5148],[-119.728,34.5218],[-119.698,34.5004],[-119.695,34.5085],[-119.694,34.5037],[-119.746,34.5232],[-119.747,34.523],[-119.744,34.5224],[-119.748,34.5243],[-119.697,34.5117],[-119.698,34.5005],[-119.748,34.5242],[-119.748,34.524],[-119.698,34.5005],[-119.742,34.5224],[-119.743,34.5223],[-119.694,34.5038],[-119.694,34.5007],[-119.723,34.5216],[-119.742,34.5224],[-119.748,34.5242],[-119.725,34.5253],[-119.692,34.5061],[-119.747,34.5231],[-119.742,34.5224],[-119.695,34.5079],[-119.748,34.5233],[-119.748,34.524],[-119.694,34.5006],[-119.694,34.5037],[-119.745,34.5234],[-119.695,34.5075],[-119.698,34.5003],[-119.694,34.5005],[-119.746,34.5232],[-119.694,34.5074],[-119.694,34.5074],[-119.748,34.5235],[-119.748,34.5233],[-119.693,34.5065],[-119.748,34.5241],[-119.691,34.5059],[-119.744,34.5226],[-119.741,34.522],[-119.692,34.5048],[-119.739,34.5226],[-119.745,34.5235],[-119.739,34.5232],[-119.744,34.523],[-119.698,34.5009],[-119.744,34.5226],[-119.695,34.5086],[-119.698,34.5005],[-119.743,34.5225],[-119.694,34.5004],[-119.692,34.5055],[-119.695,34.5076]];
var species = [2189,2566,2231,2233,1835,2510,2276,1621,1804,2005,1955,2025,1910,2584,1997,1998,1999,1602,1715,1716,1668,2589,2506,1671,1674,1679,1937,2162,2163,1796,1892,2265,2266,2271,2272,1802,2277,1666,1799,2165,2166,2168,2169,2170,2171,2074,2332,1913,1898,1963,1700,2334,2335,2336,2320,1670,1902,1904,2026,2278,1610,2029,1649,1651,1726,1970,2083,2087,2088,1772,2142,2323,1972,2177,2516,1681,1857,1859,1861,1863,1849,1850,1851,1731,2302,1667,2280,2125,1735,2546,1915,2197,2198,1872,1793,1682,2040,1746,1701,1845,2221,2225,2227,2404,1778,1779,1817,2183,2191,2193,2242,2245,2041,1838,2558,2489,2396,2037,2524,1617,1622,1980,1983,1656,1991,1922,2504,2303,2304,2285,1749,1839,2254,2260,1822,2275,2185,2186,2034,1877,1880,1882,1883,1843,1696,1607,1795,1684,1953,1825,1869,1826,1829,1703,2188,1683,1888,2250,2339,1833,2595];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});