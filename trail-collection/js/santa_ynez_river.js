var geolocs = [[-119.775,34.5452],[-119.772,34.5429],[-119.761,34.5397],[-119.606,34.5072],[-119.629,34.5121],[-119.765,34.5406],[-119.629,34.512],[-119.765,34.5406],[-119.629,34.5119],[-119.761,34.5397],[-119.628,34.5118],[-119.773,34.5463],[-119.776,34.5452],[-119.775,34.5452],[-119.759,34.54],[-119.767,34.5414],[-119.606,34.5073],[-119.761,34.5397],[-119.629,34.512],[-119.764,34.5402],[-119.752,34.5394],[-119.606,34.5072],[-119.771,34.5423],[-119.772,34.5427],[-119.601,34.5122],[-119.765,34.5417],[-119.787,34.5486],[-119.628,34.5119],[-119.765,34.5405],[-119.769,34.5417],[-119.767,34.5405],[-119.775,34.5451],[-119.607,34.5072],[-119.63,34.5124],[-119.774,34.5434],[-119.773,34.5432],[-119.775,34.5446],[-119.774,34.5438],[-119.628,34.5118],[-119.776,34.5448],[-119.542,34.4864],[-119.742,34.5407],[-119.739,34.5401],[-119.542,34.4864],[-119.63,34.5123],[-119.768,34.5397],[-119.775,34.5442],[-119.629,34.512],[-119.628,34.5119],[-119.775,34.5452],[-119.629,34.5122],[-119.629,34.512],[-119.606,34.5072],[-119.756,34.5399],[-119.764,34.5402],[-119.755,34.5398],[-119.775,34.5443],[-119.764,34.5404],[-119.768,34.5415],[-119.763,34.5402],[-119.63,34.5124],[-119.762,34.5398],[-119.629,34.5122],[-119.775,34.5445],[-119.774,34.5435],[-119.764,34.54],[-119.777,34.546],[-119.766,34.5397],[-119.601,34.5118],[-119.766,34.5396],[-119.758,34.54],[-119.765,34.5403],[-119.606,34.5072],[-119.77,34.5424],[-119.769,34.5438],[-119.771,34.5459],[-119.769,34.5436],[-119.761,34.5392],[-119.765,34.5406],[-119.761,34.5397],[-119.774,34.5435],[-119.442,34.4907],[-119.747,34.5387],[-119.775,34.5447],[-119.772,34.5428],[-119.625,34.512],[-119.761,34.5396],[-119.762,34.5399],[-119.776,34.5452],[-119.542,34.4865],[-119.775,34.5451],[-119.77,34.5429],[-119.541,34.4864],[-119.77,34.5422],[-119.607,34.5071],[-119.777,34.5459],[-119.765,34.5394],[-119.775,34.5446],[-119.769,34.5419],[-119.775,34.5449],[-119.775,34.544],[-119.777,34.5459],[-119.725,34.535],[-119.606,34.5072],[-119.768,34.5403],[-119.542,34.4864],[-119.63,34.5125],[-119.765,34.5397],[-119.765,34.5406],[-119.606,34.5071],[-119.752,34.5394],[-119.623,34.5095],[-119.629,34.5123],[-119.77,34.5426],[-119.768,34.5402],[-119.773,34.5464],[-119.605,34.5076],[-119.761,34.5404],[-119.541,34.4865],[-119.628,34.5119],[-119.763,34.5401],[-119.773,34.543],[-119.76,34.5401],[-119.775,34.5443],[-119.765,34.5397],[-119.768,34.5403],[-119.775,34.5442],[-119.775,34.5441],[-119.606,34.5071],[-119.762,34.5398],[-119.777,34.5456],[-119.629,34.512],[-119.776,34.5447],[-119.713,34.5346],[-119.774,34.5437],[-119.63,34.5122],[-119.761,34.5397],[-119.762,34.5398],[-119.629,34.512],[-119.756,34.5399],[-119.754,34.5395],[-119.775,34.5449],[-119.606,34.5072],[-119.63,34.5124],[-119.771,34.5429],[-119.63,34.5121],[-119.63,34.5124],[-119.749,34.5383],[-119.776,34.5456],[-119.768,34.5403],[-119.765,34.5406],[-119.777,34.5456],[-119.629,34.5119],[-119.627,34.5118],[-119.762,34.5399],[-119.764,34.5406],[-119.773,34.5432],[-119.767,34.5398],[-119.625,34.5112],[-119.606,34.5073],[-119.773,34.5432],[-119.628,34.5117],[-119.63,34.5126],[-119.768,34.5413],[-119.77,34.5426],[-119.768,34.5402],[-119.629,34.5119],[-119.77,34.5423],[-119.631,34.5127]];
var species = [2233,2406,1804,1764,2386,2584,2535,2319,2725,1708,1600,2208,1715,1717,2113,1759,1576,2413,1671,1935,1937,1897,2265,2271,2272,2051,1799,1573,2171,2074,2332,2333,2561,1913,1718,2294,1963,1945,1670,2695,1967,2174,1725,1968,2087,2088,1772,1906,2323,1727,1691,1730,1966,1667,1733,1734,2125,1735,1638,2512,1915,1916,1814,1865,2198,1793,2721,2211,2227,2156,1779,2151,1817,2191,1713,2242,2244,2245,1907,2129,2490,2396,2179,2524,2526,1618,1976,1979,1982,1988,2616,1991,2181,2455,1923,2317,2656,2621,1612,2534,2303,2400,2389,1750,1751,2254,2185,2186,2331,2290,2108,2305,1877,1880,1882,1843,1696,2133,1829,1846,2691,2111,2135,2188,1659,2339,1833,2520,1931,1925,2203,1840];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});