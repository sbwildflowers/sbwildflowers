var geolocs = [[-120.227,34.4975],[-120.207,34.4932],[-120.208,34.4904],[-120.241,34.4865],[-120.209,34.4904],[-120.204,34.4968],[-120.214,34.5033],[-120.228,34.4713],[-120.204,34.4959],[-120.23,34.4716],[-120.179,34.5097],[-120.202,34.5003],[-120.208,34.5037],[-120.223,34.4958],[-120.237,34.4888],[-120.23,34.4718],[-120.211,34.4899],[-120.205,34.4926],[-120.204,34.4927],[-120.204,34.4984],[-120.216,34.5031],[-120.206,34.4913],[-120.216,34.5031],[-120.223,34.5041],[-120.237,34.4928],[-120.228,34.4712],[-120.204,34.4931],[-120.236,34.4952],[-120.23,34.4716],[-120.226,34.5],[-120.207,34.4903],[-120.22,34.4967],[-120.224,34.505],[-120.206,34.4913],[-120.211,34.49],[-120.225,34.5027],[-120.234,34.4965],[-120.222,34.5024],[-120.241,34.4862],[-120.208,34.4904],[-120.226,34.4959],[-120.204,34.4962],[-120.206,34.4916],[-120.207,34.5039],[-120.189,34.5075],[-120.226,34.4972],[-120.215,34.5042],[-120.237,34.4899],[-120.224,34.4983],[-120.223,34.4991],[-120.207,34.4908],[-120.208,34.493],[-120.234,34.4966],[-120.222,34.4962],[-120.183,34.5085],[-120.213,34.5031],[-120.199,34.5017],[-120.22,34.4966],[-120.238,34.4886],[-120.206,34.4902],[-120.207,34.4904],[-120.206,34.4917],[-120.215,34.5028],[-120.204,34.4959],[-120.199,34.5018],[-120.211,34.494],[-120.189,34.5076],[-120.237,34.4897],[-120.204,34.4927],[-120.209,34.5035],[-120.226,34.4985],[-120.206,34.493],[-120.184,34.5084],[-120.238,34.4884],[-120.203,34.5027],[-120.223,34.4957],[-120.201,34.5033],[-120.199,34.5018],[-120.192,34.5061],[-120.206,34.4913],[-120.216,34.5038],[-120.221,34.5032],[-120.226,34.4992],[-120.226,34.5017],[-120.234,34.4907],[-120.207,34.4908],[-120.218,34.4961],[-120.224,34.5035],[-120.221,34.4966],[-120.2,34.5007],[-120.186,34.5081],[-120.211,34.4939],[-120.215,34.5029],[-120.23,34.4716],[-120.203,34.4978],[-120.183,34.5084],[-120.201,34.5028],[-120.216,34.5038],[-120.238,34.4897],[-120.204,34.4988],[-120.206,34.4902],[-120.207,34.4912],[-120.222,34.4961],[-120.241,34.4863],[-120.224,34.504],[-120.227,34.497],[-120.237,34.4934],[-120.21,34.4901],[-120.222,34.5013],[-120.181,34.5093],[-120.204,34.4988],[-120.207,34.491],[-120.231,34.4905],[-120.223,34.4957],[-120.223,34.4974],[-120.189,34.5074],[-120.226,34.4978],[-120.223,34.4996],[-120.198,34.5035],[-120.233,34.4909],[-120.223,34.4974],[-120.232,34.4909],[-120.227,34.4964],[-120.206,34.4912],[-120.216,34.4967],[-120.226,34.4959],[-120.226,34.4969],[-120.22,34.4967],[-120.202,34.5025],[-120.204,34.4984],[-120.226,34.496],[-120.223,34.4969],[-120.215,34.503],[-120.207,34.4914],[-120.21,34.4901],[-120.21,34.4939],[-120.206,34.4931],[-120.238,34.4914],[-120.188,34.5078],[-120.206,34.4913],[-120.206,34.4932],[-120.234,34.4968],[-120.205,34.4935],[-120.215,34.5029],[-120.207,34.4909],[-120.214,34.5036],[-120.222,34.4963],[-120.226,34.4958],[-120.222,34.4966],[-120.23,34.4721],[-120.185,34.5083],[-120.241,34.4862],[-120.226,34.4978],[-120.219,34.4966],[-120.222,34.5021],[-120.22,34.5034],[-120.201,34.5033],[-120.226,34.4981],[-120.222,34.4998],[-120.216,34.5039],[-120.203,34.4977],[-120.227,34.4993],[-120.204,34.4927],[-120.203,34.4991],[-120.223,34.4961],[-120.233,34.4907],[-120.222,34.4963],[-120.21,34.4903],[-120.207,34.4912],[-120.213,34.4945],[-120.206,34.505],[-120.207,34.4904],[-120.208,34.4903],[-120.183,34.5084],[-120.203,34.4976],[-120.237,34.4928],[-120.223,34.4995],[-120.209,34.5035],[-120.21,34.4904],[-120.222,34.5017],[-120.207,34.4904],[-120.229,34.4904],[-120.226,34.5006],[-120.203,34.5025],[-120.223,34.4978],[-120.209,34.4899],[-120.228,34.4714],[-120.23,34.4718],[-120.178,34.5098],[-120.215,34.5028],[-120.238,34.4911],[-120.225,34.5026],[-120.212,34.4946],[-120.204,34.4959],[-120.191,34.5066],[-120.21,34.4904],[-120.238,34.4828],[-120.234,34.4963],[-120.224,34.5032],[-120.206,34.4902],[-120.205,34.4941],[-120.234,34.4971],[-120.237,34.4924],[-120.206,34.4946],[-120.222,34.501],[-120.238,34.4829],[-120.237,34.4925],[-120.221,34.5034],[-120.191,34.507],[-120.2,34.501],[-120.223,34.4958],[-120.238,34.4908],[-120.206,34.4911],[-120.23,34.4718],[-120.206,34.4911],[-120.2,34.5011],[-120.216,34.5041],[-120.214,34.5034],[-120.237,34.4937],[-120.234,34.4965],[-120.235,34.4963],[-120.225,34.5027],[-120.234,34.4964],[-120.204,34.4972],[-120.226,34.4959],[-120.238,34.4828],[-120.216,34.503],[-120.205,34.4934],[-120.209,34.5035],[-120.237,34.494],[-120.208,34.4932],[-120.219,34.4966],[-120.222,34.4962],[-120.215,34.5028],[-120.216,34.5039],[-120.223,34.4996],[-120.207,34.4911],[-120.206,34.5039],[-120.223,34.5041],[-120.206,34.5042],[-120.226,34.4985],[-120.237,34.4934],[-120.222,34.5005],[-120.219,34.503],[-120.202,34.5],[-120.179,34.5097],[-120.222,34.4961],[-120.222,34.4961],[-120.223,34.498],[-120.222,34.504],[-120.238,34.4883],[-120.234,34.4907],[-120.224,34.5039],[-120.226,34.4976],[-120.215,34.5041],[-120.203,34.5031],[-120.199,34.5018],[-120.216,34.5032],[-120.234,34.4906],[-120.222,34.5016],[-120.204,34.4926],[-120.222,34.4962],[-120.238,34.4883],[-120.216,34.5037],[-120.209,34.4903],[-120.201,34.5007],[-120.222,34.502],[-120.224,34.5051],[-120.215,34.4962],[-120.206,34.4911],[-120.237,34.4903],[-120.226,34.498],[-120.222,34.5007],[-120.216,34.5037],[-120.225,34.5026],[-120.238,34.4897],[-120.224,34.504],[-120.225,34.5046],[-120.223,34.499],[-120.218,34.5036],[-120.238,34.4914],[-120.226,34.4961],[-120.207,34.4903],[-120.223,34.5041],[-120.221,34.5015],[-120.213,34.5033],[-120.191,34.5072],[-120.226,34.4972],[-120.238,34.4889],[-120.212,34.4946],[-120.211,34.4902],[-120.224,34.4957],[-120.211,34.4901],[-120.237,34.4902],[-120.221,34.5032],[-120.22,34.5032],[-120.216,34.4965],[-120.215,34.5029],[-120.191,34.5071],[-120.206,34.4902],[-120.234,34.4907],[-120.226,34.4975],[-120.224,34.504],[-120.22,34.5036],[-120.237,34.4899],[-120.223,34.4993],[-120.212,34.5033],[-120.206,34.4932],[-120.237,34.4901],[-120.23,34.4715],[-120.206,34.4912],[-120.207,34.4928],[-120.238,34.4883],[-120.189,34.5074],[-120.207,34.491],[-120.222,34.4961],[-120.22,34.5036],[-120.184,34.5083],[-120.236,34.4892],[-120.207,34.493],[-120.208,34.4933],[-120.193,34.5059],[-120.206,34.4913],[-120.198,34.5038],[-120.237,34.4885],[-120.223,34.4961],[-120.205,34.4931],[-120.218,34.5037],[-120.226,34.4992],[-120.235,34.4953],[-120.237,34.4901],[-120.219,34.4966],[-120.205,34.4926],[-120.208,34.4933],[-120.224,34.4956],[-120.241,34.4863],[-120.237,34.4897],[-120.204,34.4929],[-120.207,34.493],[-120.226,34.4985],[-120.238,34.4897],[-120.237,34.4898],[-120.219,34.4966],[-120.205,34.4939],[-120.222,34.4962],[-120.208,34.4932],[-120.237,34.4884],[-120.223,34.4961],[-120.201,34.5008],[-120.188,34.5077],[-120.201,34.5034],[-120.222,34.5019],[-120.192,34.5061],[-120.215,34.4962],[-120.202,34.5024],[-120.225,34.5027],[-120.205,34.4953],[-120.219,34.5028],[-120.23,34.4718],[-120.221,34.5034],[-120.238,34.4909],[-120.218,34.5037],[-120.226,34.4999],[-120.235,34.496]];
var species = [1705,2231,2232,2276,1763,1910,2584,1998,2001,1707,1708,1854,2049,1640,1715,1716,1668,2069,1672,1674,1933,2118,1892,1894,2438,2266,2270,2271,2272,2052,1666,1799,1800,2166,2074,2332,1913,1690,1718,1711,2294,1959,1963,2509,1786,2334,2320,1670,1902,2026,1610,2029,1649,1766,1970,2087,2088,1772,2141,2142,2124,2324,2158,1972,1691,2273,1681,1857,1859,1863,2143,1731,2147,1667,2280,1733,2125,2282,1735,1633,2198,1872,2013,2219,2221,2224,2227,2228,2404,1817,2152,2191,2192,2193,1713,1838,1819,1820,2077,2021,2396,2314,2526,1617,1622,1983,1986,1991,2181,2241,1686,1922,2317,2671,1612,2285,1749,1750,2254,2259,1822,2368,2337,2274,2275,2184,2034,2290,2307,1883,1885,1843,1695,1696,2447,1928,1801,1684,1949,1952,1869,2067,1829,2188,1683,1888,2339,1833,2291,2520,1788,1931,2202];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});