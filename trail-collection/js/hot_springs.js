var geolocs = [[-119.64,34.4636],[-119.639,34.4547],[-119.642,34.4624],[-119.64,34.4544],[-119.643,34.4523],[-119.64,34.4631],[-119.643,34.4519],[-119.639,34.4584],[-119.639,34.4547],[-119.642,34.4625],[-119.642,34.4619],[-119.642,34.4534],[-119.64,34.4622],[-119.641,34.4625],[-119.642,34.4625],[-119.639,34.4572],[-119.638,34.4553],[-119.643,34.4621],[-119.638,34.4635],[-119.64,34.4547],[-119.643,34.4524],[-119.639,34.4576],[-119.643,34.4613],[-119.639,34.4572],[-119.639,34.4582],[-119.643,34.4518],[-119.639,34.4611],[-119.639,34.4612],[-119.64,34.4634],[-119.64,34.4628],[-119.64,34.4611],[-119.642,34.4625],[-119.643,34.4621],[-119.639,34.4554],[-119.639,34.4582],[-119.639,34.461],[-119.639,34.4627],[-119.639,34.4556],[-119.639,34.463],[-119.639,34.4594],[-119.643,34.4613],[-119.643,34.4619],[-119.643,34.4518],[-119.643,34.452],[-119.643,34.4518],[-119.643,34.4519],[-119.64,34.454],[-119.639,34.4569],[-119.638,34.4577],[-119.641,34.4635],[-119.641,34.4541],[-119.64,34.4633],[-119.639,34.457],[-119.643,34.4613],[-119.638,34.4574],[-119.642,34.4627],[-119.639,34.4597],[-119.641,34.454],[-119.642,34.4528],[-119.643,34.4519],[-119.638,34.4578],[-119.643,34.4628],[-119.64,34.4627],[-119.641,34.4628],[-119.64,34.4625],[-119.64,34.4621],[-119.639,34.4605],[-119.639,34.4584],[-119.643,34.4614],[-119.64,34.4633],[-119.642,34.4529],[-119.639,34.455],[-119.641,34.463],[-119.643,34.4615],[-119.642,34.4627],[-119.641,34.454],[-119.643,34.4523],[-119.638,34.458],[-119.643,34.4617],[-119.638,34.4564],[-119.639,34.4584],[-119.641,34.4634],[-119.638,34.4587],[-119.643,34.4524],[-119.639,34.4546],[-119.642,34.4528],[-119.639,34.4581],[-119.641,34.4628],[-119.643,34.4613],[-119.64,34.4546],[-119.639,34.4611],[-119.639,34.4571],[-119.639,34.4567],[-119.64,34.463],[-119.64,34.4632],[-119.639,34.4598],[-119.643,34.4619],[-119.638,34.4571],[-119.641,34.4632],[-119.641,34.463],[-119.643,34.4524],[-119.64,34.4538],[-119.639,34.4568],[-119.643,34.4613],[-119.64,34.4546],[-119.639,34.4602],[-119.64,34.4546],[-119.642,34.4528],[-119.643,34.4522],[-119.643,34.452],[-119.64,34.4631],[-119.639,34.4605],[-119.639,34.4583],[-119.641,34.4539],[-119.638,34.4554],[-119.639,34.4549],[-119.639,34.4602],[-119.64,34.463],[-119.643,34.4614],[-119.642,34.4619],[-119.638,34.4557],[-119.641,34.4538],[-119.639,34.4613],[-119.639,34.4583],[-119.639,34.463],[-119.637,34.4576],[-119.64,34.4629],[-119.642,34.4617],[-119.638,34.458],[-119.643,34.4624],[-119.642,34.4624],[-119.639,34.4557],[-119.639,34.463],[-119.64,34.454],[-119.639,34.4625],[-119.638,34.456],[-119.639,34.4549],[-119.641,34.4631],[-119.639,34.4603],[-119.639,34.4605],[-119.639,34.4553],[-119.64,34.4543],[-119.642,34.4527],[-119.64,34.4546],[-119.639,34.458],[-119.643,34.4526],[-119.641,34.4537],[-119.642,34.4529],[-119.642,34.4532],[-119.638,34.4576],[-119.643,34.4617],[-119.641,34.4539],[-119.639,34.4605],[-119.639,34.4606],[-119.637,34.4576],[-119.643,34.4615],[-119.639,34.4584],[-119.639,34.4548],[-119.641,34.4541],[-119.639,34.4578],[-119.639,34.4583],[-119.639,34.4612],[-119.642,34.4528],[-119.643,34.4519],[-119.639,34.463],[-119.639,34.4612],[-119.64,34.4612],[-119.639,34.4548],[-119.641,34.4536],[-119.64,34.4626],[-119.64,34.4628],[-119.642,34.4626],[-119.64,34.4618],[-119.639,34.4557],[-119.643,34.4613],[-119.639,34.4629],[-119.641,34.4538],[-119.639,34.459],[-119.639,34.4631],[-119.639,34.4581],[-119.641,34.4539],[-119.643,34.4613],[-119.64,34.4542],[-119.643,34.4614],[-119.639,34.4571],[-119.639,34.4609],[-119.638,34.4554],[-119.643,34.4619],[-119.637,34.4574],[-119.643,34.4621],[-119.643,34.4614],[-119.642,34.4528],[-119.641,34.4541],[-119.643,34.4614],[-119.639,34.4581],[-119.639,34.4557],[-119.639,34.4555],[-119.639,34.4556],[-119.639,34.4556],[-119.639,34.4618],[-119.639,34.4565],[-119.64,34.4616],[-119.641,34.4537],[-119.639,34.4569],[-119.64,34.4626],[-119.64,34.4547],[-119.639,34.4547],[-119.641,34.4538],[-119.643,34.4614],[-119.641,34.4628],[-119.639,34.4575],[-119.64,34.4618],[-119.639,34.4551],[-119.639,34.4593],[-119.641,34.4539],[-119.642,34.4628],[-119.639,34.4573],[-119.64,34.4634],[-119.639,34.4589],[-119.642,34.4532],[-119.639,34.4585],[-119.641,34.4626],[-119.642,34.4626],[-119.64,34.4624],[-119.639,34.4613],[-119.639,34.463],[-119.64,34.4628],[-119.64,34.4633],[-119.64,34.4633],[-119.639,34.4632],[-119.643,34.4614],[-119.643,34.4523],[-119.641,34.454],[-119.642,34.4528],[-119.639,34.4614],[-119.639,34.4555],[-119.643,34.4519],[-119.639,34.4566],[-119.638,34.4578],[-119.64,34.4624],[-119.639,34.4576],[-119.642,34.4621],[-119.642,34.4614],[-119.64,34.454],[-119.643,34.4618],[-119.642,34.4528],[-119.639,34.4602],[-119.639,34.4555],[-119.639,34.4572],[-119.642,34.4625],[-119.641,34.4628],[-119.639,34.4603],[-119.64,34.4622],[-119.642,34.4528],[-119.643,34.4521],[-119.639,34.463],[-119.638,34.4563],[-119.643,34.4628],[-119.64,34.4628],[-119.643,34.4517],[-119.642,34.4625],[-119.644,34.4512],[-119.642,34.4626],[-119.639,34.4584],[-119.641,34.4631],[-119.642,34.4527],[-119.639,34.4613],[-119.641,34.4538],[-119.641,34.454],[-119.639,34.4631],[-119.639,34.4584],[-119.64,34.454],[-119.642,34.4622],[-119.642,34.4627],[-119.639,34.4554],[-119.639,34.4567],[-119.639,34.4552],[-119.643,34.4613],[-119.639,34.4572],[-119.641,34.4535],[-119.64,34.4622],[-119.64,34.463],[-119.639,34.4581],[-119.639,34.4576],[-119.639,34.4573],[-119.641,34.4635],[-119.637,34.4574],[-119.639,34.4623],[-119.642,34.462],[-119.64,34.4626],[-119.641,34.4629],[-119.639,34.4577],[-119.646,34.4496],[-119.638,34.4579],[-119.641,34.4628],[-119.639,34.4554],[-119.64,34.4627],[-119.639,34.4614],[-119.64,34.4631],[-119.64,34.463],[-119.639,34.4563],[-119.641,34.4542],[-119.642,34.4533],[-119.641,34.4538],[-119.641,34.4535],[-119.639,34.4593],[-119.638,34.4587],[-119.638,34.4563],[-119.639,34.4589],[-119.641,34.4627],[-119.641,34.4628],[-119.639,34.4589],[-119.642,34.4618],[-119.639,34.4589],[-119.642,34.4619],[-119.639,34.4604],[-119.639,34.4563],[-119.639,34.4627],[-119.639,34.4572],[-119.642,34.4528],[-119.643,34.4519],[-119.639,34.463],[-119.637,34.4575],[-119.64,34.4622],[-119.64,34.4628],[-119.643,34.4615],[-119.642,34.4529],[-119.642,34.453],[-119.64,34.4633],[-119.64,34.4629],[-119.643,34.462],[-119.638,34.4635],[-119.64,34.4614],[-119.642,34.4534],[-119.642,34.4528],[-119.643,34.4518],[-119.643,34.4614],[-119.637,34.4576],[-119.643,34.4618],[-119.639,34.4615],[-119.641,34.4628],[-119.639,34.4628],[-119.639,34.4567],[-119.639,34.463],[-119.638,34.458],[-119.642,34.4626],[-119.64,34.4629],[-119.639,34.4584],[-119.639,34.4567],[-119.642,34.4626],[-119.639,34.4554],[-119.639,34.4578],[-119.639,34.4625],[-119.639,34.463],[-119.642,34.4532],[-119.639,34.4553],[-119.639,34.4612],[-119.637,34.4577],[-119.64,34.4623],[-119.64,34.4629],[-119.641,34.4631],[-119.64,34.4611],[-119.639,34.4563],[-119.639,34.455],[-119.64,34.4624],[-119.641,34.454],[-119.643,34.4617],[-119.639,34.4614],[-119.645,34.4505],[-119.645,34.4502],[-119.642,34.4623],[-119.639,34.4619],[-119.642,34.4525],[-119.639,34.4581],[-119.64,34.4622],[-119.642,34.4625],[-119.643,34.4614],[-119.643,34.4616],[-119.639,34.4584],[-119.639,34.4613],[-119.639,34.463],[-119.639,34.4583],[-119.643,34.4519],[-119.643,34.452],[-119.637,34.4576],[-119.643,34.4628],[-119.64,34.4624],[-119.64,34.4629],[-119.641,34.4539],[-119.642,34.4525],[-119.639,34.4631],[-119.639,34.4554],[-119.643,34.4614],[-119.639,34.4612],[-119.639,34.4612]];
var species = [2189,1705,2566,2231,2232,2233,2510,2276,1758,2005,2025,1909,1910,2584,1998,1707,1708,1639,1688,2449,1600,1623,1716,1717,1754,2113,1759,2069,1674,1933,1937,2162,2378,2119,1796,1896,2121,2270,2271,2272,1802,2051,2053,2080,1573,2165,2073,2074,2332,1711,1712,1963,1626,1627,1786,1792,2336,1670,1902,2699,1610,2029,2448,1649,1967,2173,2174,1609,1724,1725,1726,1970,2087,2088,1772,2142,2493,1905,1906,2324,1972,2516,2264,1691,1859,1860,1863,1731,2147,2280,1811,2125,1812,1813,1633,1634,2512,1915,1865,2718,2198,1682,1745,2219,2227,1780,1817,2191,2192,2193,1713,2245,1995,1907,2077,1660,2530,2021,2312,2314,2722,2328,2526,1617,1618,1622,2101,1980,1982,1988,1991,1924,2317,2621,1612,2285,2389,1748,1750,1751,1614,2103,2254,1822,2130,2034,2036,2301,2290,2106,2305,2306,1883,1885,1843,1695,1696,2447,1928,1607,1795,2060,2061,2062,1801,2133,1949,1953,1742,1825,1869,2508,1846,2111,1830,1703,1694,2188,1683,2140,1659,2339,2379,1833,2521,1788,1931,1855,1613,2366,2595];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});