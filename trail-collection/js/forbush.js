var geolocs = [[-119.638,34.4971],[-119.612,34.496],[-119.637,34.4978],[-119.637,34.4976],[-119.637,34.4978],[-119.637,34.4972],[-119.634,34.4971],[-119.623,34.495],[-119.627,34.4954],[-119.637,34.4977],[-119.625,34.4954],[-119.637,34.4975],[-119.638,34.4971],[-119.628,34.4954],[-119.637,34.4978],[-119.637,34.4978],[-119.638,34.4972],[-119.638,34.4972],[-119.638,34.4971],[-119.615,34.4955],[-119.636,34.4862],[-119.637,34.497],[-119.612,34.4957],[-119.613,34.4956],[-119.637,34.4971],[-119.637,34.4972],[-119.638,34.497],[-119.616,34.4952],[-119.637,34.4971],[-119.637,34.497],[-119.637,34.4955],[-119.621,34.4943],[-119.614,34.4954],[-119.638,34.4972],[-119.627,34.4955],[-119.638,34.497],[-119.622,34.4947],[-119.638,34.4969],[-119.638,34.497],[-119.638,34.4972],[-119.622,34.4944],[-119.638,34.4972],[-119.62,34.4942],[-119.638,34.4973],[-119.637,34.4964],[-119.638,34.4963],[-119.638,34.4964],[-119.635,34.4915],[-119.633,34.4961],[-119.636,34.488],[-119.638,34.4965],[-119.634,34.497],[-119.614,34.4952],[-119.638,34.4971],[-119.637,34.4971],[-119.637,34.497],[-119.612,34.4958],[-119.633,34.4961],[-119.637,34.4913],[-119.615,34.4955],[-119.634,34.5003],[-119.638,34.497],[-119.638,34.4973],[-119.613,34.4956],[-119.637,34.4971],[-119.632,34.4958],[-119.627,34.4954],[-119.637,34.4971],[-119.626,34.4954],[-119.634,34.497],[-119.627,34.4737],[-119.626,34.4736],[-119.639,34.4973],[-119.637,34.4975],[-119.638,34.4973],[-119.638,34.4973],[-119.639,34.4976],[-119.638,34.4971],[-119.633,34.4959],[-119.637,34.4977],[-119.637,34.4976],[-119.637,34.4972],[-119.637,34.4976],[-119.638,34.4972],[-119.638,34.4972],[-119.614,34.4953],[-119.637,34.497],[-119.612,34.4957],[-119.633,34.4962],[-119.616,34.4954],[-119.624,34.4952],[-119.612,34.4957],[-119.612,34.4966],[-119.636,34.4975],[-119.638,34.498],[-119.634,34.497],[-119.614,34.4955],[-119.616,34.4951],[-119.618,34.4946],[-119.618,34.4946],[-119.626,34.4954],[-119.627,34.4956],[-119.637,34.4977],[-119.638,34.4973],[-119.634,34.4968],[-119.635,34.497],[-119.637,34.4971],[-119.621,34.4944],[-119.614,34.495],[-119.637,34.4972],[-119.628,34.4953],[-119.639,34.4974],[-119.63,34.4953],[-119.622,34.4943],[-119.637,34.4971],[-119.614,34.4955],[-119.631,34.4957],[-119.613,34.4957],[-119.628,34.4955],[-119.629,34.4956],[-119.638,34.4972],[-119.625,34.4955],[-119.621,34.4943],[-119.638,34.4971],[-119.629,34.4956],[-119.638,34.4969],[-119.628,34.4954],[-119.638,34.4972],[-119.638,34.4971],[-119.617,34.4948],[-119.628,34.4953],[-119.637,34.497],[-119.625,34.4954],[-119.638,34.497],[-119.618,34.4946],[-119.637,34.4972],[-119.633,34.4963],[-119.612,34.4959],[-119.638,34.497],[-119.621,34.4943],[-119.638,34.497],[-119.624,34.4954],[-119.637,34.4972],[-119.638,34.4971],[-119.637,34.4973],[-119.637,34.4972],[-119.67,34.5191],[-119.631,34.4957],[-119.638,34.4971],[-119.638,34.4972],[-119.612,34.4963],[-119.637,34.4971],[-119.637,34.4972],[-119.613,34.4957],[-119.614,34.4953],[-119.613,34.496],[-119.639,34.4969],[-119.627,34.4955],[-119.637,34.4971],[-119.63,34.4952],[-119.67,34.5189],[-119.621,34.4943],[-119.614,34.4953],[-119.637,34.4975],[-119.634,34.497],[-119.638,34.4977],[-119.637,34.4977],[-119.638,34.4971],[-119.635,34.4974],[-119.625,34.4953],[-119.637,34.4971],[-119.638,34.4971],[-119.637,34.4978],[-119.638,34.4971],[-119.638,34.4971],[-119.638,34.4971],[-119.671,34.519],[-119.631,34.4953],[-119.629,34.4956],[-119.637,34.4978],[-119.637,34.4978],[-119.639,34.4976],[-119.623,34.4948],[-119.638,34.4972],[-119.638,34.4971],[-119.63,34.4955],[-119.637,34.498],[-119.623,34.4654],[-119.638,34.4973],[-119.612,34.4965],[-119.637,34.4972],[-119.636,34.4976],[-119.634,34.497],[-119.612,34.4964],[-119.637,34.4977],[-119.637,34.4977],[-119.637,34.4958],[-119.622,34.4666],[-119.612,34.496],[-119.635,34.498],[-119.627,34.4957],[-119.637,34.4978],[-119.612,34.4963],[-119.637,34.4954],[-119.614,34.4953],[-119.639,34.4975],[-119.612,34.496],[-119.637,34.4972],[-119.637,34.4978],[-119.634,34.4971],[-119.637,34.4971],[-119.637,34.4976],[-119.637,34.4976],[-119.637,34.4978],[-119.618,34.4947],[-119.623,34.4949],[-119.633,34.4962],[-119.637,34.4975],[-119.614,34.4955],[-119.639,34.4976],[-119.637,34.497],[-119.628,34.4953],[-119.614,34.4955],[-119.638,34.4966],[-119.62,34.4942],[-119.638,34.4966],[-119.626,34.4954],[-119.636,34.486],[-119.615,34.4955],[-119.638,34.4971],[-119.63,34.4954],[-119.638,34.497],[-119.632,34.4958],[-119.639,34.4975],[-119.639,34.4854],[-119.635,34.4971],[-119.638,34.497],[-119.638,34.4972],[-119.634,34.4965],[-119.631,34.4958],[-119.638,34.4973],[-119.636,34.4857],[-119.626,34.4954],[-119.638,34.4972],[-119.63,34.4954],[-119.638,34.498],[-119.631,34.4955],[-119.637,34.497],[-119.612,34.4964],[-119.629,34.4956],[-119.638,34.4979],[-119.638,34.4971],[-119.637,34.497],[-119.636,34.4975],[-119.629,34.4956],[-119.631,34.4957],[-119.614,34.4953],[-119.638,34.4973],[-119.638,34.4973],[-119.613,34.4959],[-119.637,34.4971],[-119.637,34.4971],[-119.613,34.4957],[-119.637,34.497],[-119.613,34.4955],[-119.637,34.4975],[-119.638,34.4972],[-119.638,34.4971],[-119.638,34.4972],[-119.612,34.4958],[-119.634,34.497],[-119.638,34.4969],[-119.634,34.4969],[-119.612,34.496],[-119.612,34.4961],[-119.626,34.4955],[-119.637,34.4971],[-119.613,34.4955],[-119.637,34.4971],[-119.638,34.4971],[-119.613,34.4958],[-119.637,34.497],[-119.637,34.4962],[-119.627,34.4955],[-119.637,34.4971],[-119.638,34.4971],[-119.637,34.4971],[-119.638,34.4971],[-119.637,34.4973],[-119.637,34.4975],[-119.637,34.4974],[-119.637,34.4974],[-119.637,34.4971],[-119.614,34.4954],[-119.638,34.4972],[-119.637,34.497],[-119.616,34.4955],[-119.614,34.4954],[-119.636,34.486],[-119.637,34.4978],[-119.612,34.4957],[-119.634,34.497],[-119.612,34.4958],[-119.637,34.4971],[-119.618,34.4947],[-119.638,34.4972],[-119.637,34.497],[-119.618,34.4946],[-119.622,34.4943],[-119.637,34.4977],[-119.638,34.4972],[-119.616,34.4951],[-119.638,34.4971],[-119.638,34.4971],[-119.639,34.4965],[-119.637,34.4971],[-119.637,34.497],[-119.638,34.497],[-119.638,34.4973],[-119.625,34.4953],[-119.635,34.497],[-119.638,34.4968],[-119.621,34.4943],[-119.637,34.4958],[-119.634,34.5006],[-119.635,34.4975],[-119.628,34.4954],[-119.627,34.4954],[-119.637,34.4971],[-119.638,34.4972],[-119.627,34.4955],[-119.637,34.4978],[-119.614,34.4953],[-119.637,34.4978],[-119.635,34.4973],[-119.612,34.4965],[-119.627,34.4956],[-119.638,34.4971],[-119.637,34.4972],[-119.637,34.4972],[-119.615,34.4955],[-119.637,34.4971],[-119.638,34.4971],[-119.613,34.4958],[-119.636,34.4973],[-119.614,34.4953],[-119.634,34.4967],[-119.621,34.4941],[-119.637,34.4958],[-119.638,34.497],[-119.634,34.4967],[-119.638,34.4972],[-119.637,34.4971],[-119.636,34.4975],[-119.637,34.4975],[-119.638,34.4971],[-119.638,34.4972],[-119.621,34.4942],[-119.638,34.497],[-119.637,34.4955],[-119.638,34.4966],[-119.638,34.4971],[-119.629,34.4955],[-119.639,34.4976],[-119.63,34.4953],[-119.638,34.4971],[-119.638,34.4971],[-119.622,34.4945],[-119.626,34.4954],[-119.614,34.4955],[-119.634,34.4968],[-119.671,34.519],[-119.638,34.497],[-119.638,34.4971],[-119.615,34.4955],[-119.622,34.4942],[-119.671,34.519],[-119.637,34.4971],[-119.622,34.4946],[-119.619,34.4941],[-119.634,34.4959],[-119.631,34.4958],[-119.638,34.4972],[-119.638,34.4971],[-119.638,34.4968],[-119.637,34.4971],[-119.62,34.4941],[-119.612,34.4961],[-119.632,34.4958],[-119.612,34.4966],[-119.638,34.4973],[-119.637,34.4972],[-119.618,34.4946],[-119.671,34.519],[-119.636,34.4911],[-119.612,34.4966],[-119.634,34.4965],[-119.628,34.4955],[-119.632,34.4957],[-119.637,34.4971],[-119.622,34.4945],[-119.638,34.497],[-119.636,34.4864],[-119.626,34.4954],[-119.634,34.497],[-119.637,34.496],[-119.638,34.4972],[-119.629,34.4956],[-119.634,34.497],[-119.623,34.4948],[-119.635,34.4973],[-119.636,34.4976],[-119.62,34.4941],[-119.636,34.4869],[-119.614,34.4953],[-119.638,34.4969],[-119.638,34.4969],[-119.637,34.4963],[-119.638,34.497],[-119.638,34.4967],[-119.638,34.4969],[-119.636,34.4877],[-119.637,34.4963],[-119.637,34.4964],[-119.638,34.497],[-119.638,34.4969],[-119.638,34.4969],[-119.626,34.4955],[-119.615,34.4954],[-119.637,34.4955],[-119.638,34.4972],[-119.639,34.4974],[-119.626,34.4954],[-119.63,34.4953],[-119.626,34.4954],[-119.614,34.4955],[-119.636,34.4974],[-119.63,34.4955],[-119.638,34.4972],[-119.634,34.4959],[-119.629,34.4957],[-119.637,34.4971],[-119.638,34.4968],[-119.617,34.495],[-119.638,34.4971],[-119.621,34.4942],[-119.633,34.4961],[-119.638,34.4968],[-119.638,34.497],[-119.615,34.4954],[-119.638,34.4976],[-119.631,34.4956],[-119.638,34.4968],[-119.639,34.4976],[-119.616,34.4954],[-119.638,34.4971],[-119.633,34.4961],[-119.636,34.4863],[-119.623,34.4655],[-119.63,34.4953],[-119.63,34.4954],[-119.63,34.4956],[-119.638,34.4971],[-119.615,34.4955],[-119.638,34.497],[-119.638,34.4969],[-119.62,34.4942],[-119.623,34.4689],[-119.629,34.477],[-119.633,34.4964],[-119.628,34.4953],[-119.638,34.4972],[-119.637,34.4971],[-119.617,34.4947],[-119.636,34.4859],[-119.615,34.4954],[-119.637,34.4972],[-119.619,34.494],[-119.62,34.4938],[-119.638,34.4971],[-119.625,34.4953],[-119.638,34.4972],[-119.637,34.4971],[-119.638,34.4972],[-119.612,34.4963],[-119.637,34.497],[-119.627,34.4956],[-119.637,34.4977],[-119.637,34.4979],[-119.614,34.4955],[-119.638,34.497],[-119.637,34.4959],[-119.638,34.4969],[-119.638,34.4964],[-119.627,34.4955],[-119.637,34.4972],[-119.637,34.4977],[-119.626,34.4955],[-119.637,34.4977],[-119.637,34.4978],[-119.637,34.4977],[-119.637,34.4971],[-119.637,34.4971],[-119.613,34.4955],[-119.637,34.4971]];
var species = [2563,2229,2231,2233,2234,2510,2276,2596,1804,1806,1807,2252,2195,2025,2348,2531,2443,2707,2584,1997,1998,1999,1707,1709,1853,2449,1600,2208,1716,1668,2587,2589,2659,2113,1759,1760,1669,1643,2435,2413,1671,1674,1679,2419,1935,1937,2160,2162,2163,2378,2397,2117,2119,1796,1895,1896,2265,2266,2271,1802,1803,2277,1752,2515,2080,1797,1798,1799,1573,2165,2167,2168,2169,2171,2074,2332,2522,1913,1898,1718,2458,2294,1963,1942,2194,1700,2334,2335,2336,2590,1670,2652,1902,1904,2123,2278,2279,1610,2448,1649,1651,1967,2172,2173,2174,2010,1726,1968,2083,2087,2088,2093,1772,2141,2142,2493,1906,2324,1972,2177,2516,2364,2273,1890,2150,1857,1859,1863,1850,1851,2143,2664,2012,2598,2599,1731,2495,2654,1667,2280,1734,2125,1812,2739,2546,2512,1814,1782,1865,2451,2607,2608,2609,1774,2198,2541,1793,2013,2370,2016,1682,1842,1745,1746,1701,1702,1844,1845,2211,2213,2218,2224,2227,2228,2706,2404,1777,1779,1817,2283,2191,2192,2193,2464,2465,2242,2244,2245,1874,1838,1820,1876,2021,2557,2558,1973,1974,2486,2489,2490,2396,1891,1689,2037,2524,2525,2526,2365,1617,1919,1622,2619,1980,1983,1656,1991,2182,2455,1922,2317,1612,1611,2303,2285,1749,1750,1839,2103,2254,2260,1822,2275,2185,2186,2031,2032,2034,2035,2288,2290,2104,2106,2307,2308,1877,1880,1883,1843,1696,2447,2394,1928,2647,2061,2133,1684,1953,1742,1825,1606,1869,2067,1826,1829,2686,2682,2135,1692,1694,2188,2678,2550,1888,1889,2247,2250,2339,1833,2520,1931,2202,2310,2595];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});