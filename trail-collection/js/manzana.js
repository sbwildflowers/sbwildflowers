var geolocs = [[-119.988,34.8042],[-119.902,34.7598],[-119.999,34.8238],[-119.906,34.7649],[-119.93,34.7669],[-119.957,34.7776],[-119.995,34.8254],[-120.006,34.8105],[-119.778,34.7568],[-119.952,34.775],[-119.807,34.7576],[-119.869,34.7373],[-119.935,34.7683],[-120.007,34.8092],[-119.989,34.804],[-119.998,34.8238],[-119.991,34.7979],[-119.928,34.7664],[-119.952,34.7748],[-119.895,34.7585],[-119.956,34.7792],[-119.923,34.7663],[-119.851,34.7466],[-119.968,34.7857],[-119.997,34.8004],[-119.901,34.7596],[-119.903,34.7598],[-119.892,34.7544],[-119.955,34.777],[-119.945,34.772],[-119.783,34.755],[-119.998,34.8239],[-119.986,34.801],[-119.903,34.7602],[-119.936,34.7697],[-119.929,34.7661],[-119.99,34.804],[-119.87,34.7374],[-119.929,34.7664],[-119.952,34.7755],[-119.995,34.7983],[-119.963,34.7818],[-119.999,34.8003],[-119.809,34.7577],[-119.951,34.7742],[-119.883,34.7361],[-119.925,34.7661],[-119.963,34.7824],[-119.93,34.7667],[-120,34.8137],[-119.806,34.7582],[-119.925,34.766],[-119.905,34.7627],[-119.957,34.7777],[-119.871,34.7375],[-119.984,34.8],[-119.947,34.7728],[-119.999,34.8149],[-119.987,34.8025],[-119.917,34.7657],[-119.995,34.8258],[-119.985,34.8007],[-119.927,34.7659],[-119.951,34.7742],[-120.007,34.8081],[-119.995,34.8255],[-119.906,34.7649],[-119.885,34.7363],[-119.976,34.7883],[-119.823,34.7513],[-119.774,34.7606],[-119.998,34.8003],[-119.838,34.7506],[-119.974,34.788],[-119.991,34.8013],[-119.93,34.7669],[-119.985,34.801],[-119.892,34.7544],[-119.957,34.7794],[-119.888,34.7406],[-119.805,34.7584],[-119.985,34.801],[-119.889,34.7478],[-119.981,34.7904],[-119.789,34.7556],[-119.959,34.78],[-119.995,34.8255],[-119.933,34.7681],[-119.982,34.7975],[-120.005,34.8125],[-119.995,34.8257],[-119.993,34.7976],[-119.989,34.8043],[-119.885,34.7364],[-119.999,34.8186],[-119.87,34.7374],[-119.892,34.7544],[-119.851,34.7461],[-119.894,34.7569],[-119.992,34.7979],[-119.851,34.7467],[-119.93,34.7663],[-119.949,34.7745],[-119.883,34.7363],[-119.992,34.8004],[-119.839,34.7503],[-119.999,34.8197],[-119.842,34.7506],[-119.906,34.7638],[-119.932,34.7679],[-119.96,34.7805],[-119.84,34.7503],[-119.989,34.8041],[-119.885,34.7364],[-119.974,34.788],[-119.93,34.7668],[-119.952,34.7753],[-119.995,34.7984],[-119.926,34.7659],[-119.93,34.7669],[-119.947,34.773],[-119.995,34.7984],[-119.776,34.7598],[-119.949,34.7743],[-119.905,34.7626],[-119.915,34.7655],[-119.949,34.7745],[-119.884,34.7365],[-119.851,34.7475],[-119.951,34.7742],[-119.93,34.7669],[-119.946,34.7721],[-119.839,34.7503],[-119.874,34.7353],[-119.998,34.8004],[-119.857,34.7435],[-119.951,34.7743],[-119.875,34.7354],[-119.987,34.803],[-119.904,34.7617],[-119.955,34.7767],[-119.875,34.7354],[-119.991,34.7977],[-119.982,34.7976],[-119.885,34.7363],[-120.002,34.8015],[-119.928,34.7664],[-119.981,34.791],[-119.991,34.8026],[-119.931,34.768],[-119.995,34.8259],[-119.99,34.8035],[-119.92,34.7657],[-120,34.8162],[-119.884,34.7365],[-119.925,34.7665],[-119.929,34.7665],[-119.981,34.7928],[-119.995,34.8257],[-119.973,34.7882],[-119.933,34.7681],[-119.923,34.7664],[-119.98,34.7898],[-119.925,34.7665],[-119.945,34.7719],[-119.887,34.7382],[-119.925,34.7665],[-119.905,34.7625],[-119.901,34.7608],[-119.951,34.7742],[-119.995,34.8257],[-119.996,34.8239],[-119.995,34.8254],[-119.965,34.7839],[-119.775,34.7607],[-120.007,34.8092],[-119.936,34.7697],[-119.931,34.768],[-119.994,34.8257],[-119.989,34.804],[-119.999,34.8238],[-119.936,34.7693],[-119.995,34.8255],[-119.775,34.7602],[-119.935,34.7685],[-119.961,34.7807],[-119.996,34.8002],[-119.982,34.7977],[-119.869,34.7374],[-120.006,34.8097],[-119.928,34.7664],[-119.957,34.7777],[-119.928,34.7663],[-119.785,34.7555],[-119.963,34.7819],[-119.891,34.753],[-120.001,34.8145],[-119.924,34.7666],[-119.945,34.772],[-119.928,34.7663],[-120.007,34.8088],[-119.869,34.7374],[-119.873,34.7357],[-119.946,34.7722],[-119.93,34.7669],[-119.986,34.8012],[-119.873,34.7357],[-119.997,34.8238],[-119.936,34.7697],[-119.932,34.7681],[-119.858,34.7436],[-119.997,34.8238],[-119.995,34.8258],[-119.925,34.7664],[-119.951,34.7742],[-119.99,34.8037],[-119.875,34.7354],[-120.007,34.8089],[-119.774,34.7603],[-119.786,34.7561],[-119.99,34.8034],[-119.883,34.7362],[-119.987,34.8032],[-119.957,34.7794],[-119.778,34.7573],[-119.988,34.8032],[-119.995,34.8258],[-119.826,34.7508],[-120,34.8167],[-119.937,34.7703],[-119.841,34.7514],[-119.926,34.7659],[-119.981,34.7909],[-119.905,34.7639],[-119.866,34.7389],[-119.774,34.7605],[-120.007,34.8081],[-119.925,34.7664],[-120.001,34.8144],[-119.787,34.7561],[-119.931,34.768],[-119.963,34.7825],[-119.777,34.7585],[-119.967,34.7851],[-119.888,34.7435],[-119.99,34.8038],[-119.888,34.7426],[-119.964,34.7827],[-119.995,34.8258],[-119.945,34.7721],[-119.952,34.7753],[-119.928,34.7663],[-119.777,34.7592],[-119.999,34.8195],[-119.93,34.7667],[-119.926,34.7659],[-119.953,34.776],[-119.932,34.7681],[-119.906,34.7638],[-119.961,34.7808],[-119.934,34.7685],[-119.888,34.7389],[-119.834,34.7504],[-119.977,34.7888],[-119.806,34.7584],[-119.951,34.7744],[-119.93,34.7667],[-119.991,34.7976],[-119.965,34.7839],[-119.997,34.8005],[-119.995,34.8258],[-119.925,34.7664]];
var species = [1705,2229,2231,2233,2234,1835,2406,2276,1621,2252,1955,2386,2341,2531,1910,1999,1708,1709,1853,1854,1841,1600,1602,1715,1717,1668,2038,1759,1760,1671,1673,1678,1679,1937,2160,2163,2397,1892,1897,2120,2266,2269,2277,2080,1798,1799,2165,2166,2168,2169,2171,2072,2074,2332,1913,1898,1718,2294,1962,1963,1942,2194,1786,2336,2320,1670,1902,2026,2123,2029,2030,2321,1649,1967,2173,1722,1726,1968,1970,2083,2087,2088,2093,1772,2141,2142,2323,2177,2516,1727,2273,1890,1857,1859,1863,2012,1730,1731,1667,2280,2237,1638,2353,2512,1914,1915,1814,1774,2198,1793,2013,2016,1755,2018,1702,1845,2224,2227,1779,1780,2151,1817,2193,1713,2242,2244,2245,1994,1995,2041,1876,2021,2518,2396,1689,2524,2525,1617,1618,1917,1919,1622,1980,1983,1986,1987,1991,2181,2446,2357,1922,2317,1848,1612,2303,2285,1749,1750,1751,2254,2257,2259,2260,1822,2337,2275,2032,2288,2307,2308,1877,1880,1882,1883,1885,1843,1696,1697,1607,2154,2133,1952,1953,1826,1829,2457,2188,1888,1889,2247,2339,1833,1931,1925,2310,1840];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});