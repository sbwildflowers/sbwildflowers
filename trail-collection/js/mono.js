var geolocs = [[-119.631,34.5143],[-119.63,34.5224],[-119.63,34.5217],[-119.633,34.5163],[-119.63,34.5217],[-119.628,34.5217],[-119.633,34.5171],[-119.634,34.5169],[-119.633,34.5172],[-119.63,34.5211],[-119.632,34.5142],[-119.627,34.522],[-119.631,34.5141],[-119.626,34.5237],[-119.627,34.5252],[-119.627,34.5242],[-119.627,34.5223],[-119.627,34.5222],[-119.633,34.5161],[-119.63,34.5109],[-119.63,34.5224],[-119.626,34.5237],[-119.629,34.5214],[-119.628,34.523],[-119.63,34.5225],[-119.631,34.5212],[-119.631,34.5303],[-119.631,34.5092],[-119.631,34.5205],[-119.633,34.5172],[-119.628,34.5279],[-119.631,34.5089],[-119.633,34.5157],[-119.631,34.5093],[-119.631,34.5204],[-119.631,34.5209],[-119.631,34.5184],[-119.631,34.5105],[-119.631,34.5103],[-119.628,34.5281],[-119.631,34.5212],[-119.631,34.5091],[-119.631,34.5183],[-119.631,34.5081],[-119.631,34.5092],[-119.631,34.5093],[-119.63,34.513],[-119.628,34.5269],[-119.627,34.5225],[-119.629,34.5124],[-119.628,34.5278],[-119.627,34.5222],[-119.629,34.529],[-119.631,34.5091],[-119.631,34.5091],[-119.631,34.5095],[-119.631,34.5099],[-119.631,34.508],[-119.63,34.5111],[-119.631,34.5089],[-119.63,34.5225],[-119.631,34.5093],[-119.631,34.5081],[-119.63,34.5281],[-119.628,34.5217],[-119.63,34.5109],[-119.631,34.5205],[-119.631,34.5214],[-119.632,34.5144],[-119.632,34.5144],[-119.629,34.5124],[-119.631,34.5094],[-119.631,34.5084],[-119.632,34.5078],[-119.631,34.5079],[-119.63,34.5116],[-119.631,34.5089],[-119.632,34.5082],[-119.634,34.5169],[-119.633,34.5173],[-119.631,34.5089],[-119.631,34.5205],[-119.631,34.5083],[-119.628,34.524],[-119.631,34.521],[-119.632,34.5177],[-119.631,34.5088],[-119.632,34.5146],[-119.631,34.5212],[-119.63,34.5292],[-119.631,34.5209],[-119.63,34.5115],[-119.63,34.5115],[-119.631,34.5079],[-119.628,34.5292],[-119.63,34.5112],[-119.631,34.5079],[-119.632,34.5079],[-119.631,34.508],[-119.632,34.5148],[-119.631,34.5192],[-119.628,34.5264],[-119.629,34.5226],[-119.63,34.5213],[-119.63,34.5121],[-119.631,34.53],[-119.63,34.5115],[-119.63,34.521],[-119.633,34.5172],[-119.631,34.5081],[-119.632,34.5147],[-119.627,34.5269],[-119.631,34.5104],[-119.634,34.5169],[-119.628,34.5279],[-119.63,34.5118],[-119.627,34.522],[-119.63,34.5298],[-119.63,34.5299],[-119.628,34.5217],[-119.627,34.5221],[-119.63,34.5285],[-119.631,34.5183],[-119.63,34.5292],[-119.63,34.513],[-119.628,34.5272],[-119.63,34.5108],[-119.63,34.5114],[-119.633,34.5172],[-119.63,34.5213],[-119.631,34.5104],[-119.631,34.5189],[-119.63,34.5108],[-119.631,34.5089],[-119.63,34.5113],[-119.627,34.5269],[-119.631,34.509],[-119.629,34.5213],[-119.631,34.5083],[-119.63,34.5114],[-119.633,34.5157],[-119.63,34.5218],[-119.629,34.5293],[-119.631,34.5088],[-119.628,34.5286],[-119.631,34.5079],[-119.63,34.5109],[-119.631,34.508],[-119.631,34.509],[-119.627,34.5227],[-119.63,34.5115],[-119.63,34.5298],[-119.631,34.5209],[-119.631,34.509],[-119.63,34.5116],[-119.631,34.5202],[-119.628,34.5269],[-119.631,34.5089],[-119.631,34.5089],[-119.631,34.5221],[-119.63,34.5115],[-119.627,34.5226],[-119.628,34.5269],[-119.631,34.5294],[-119.63,34.5299],[-119.631,34.5183],[-119.63,34.5118],[-119.627,34.5221],[-119.63,34.5108],[-119.63,34.5122],[-119.631,34.5085],[-119.633,34.5161],[-119.63,34.5219],[-119.631,34.5204],[-119.631,34.5089],[-119.633,34.5158],[-119.63,34.5121],[-119.63,34.5121],[-119.631,34.521],[-119.63,34.5109],[-119.631,34.5305],[-119.631,34.5305],[-119.63,34.5119],[-119.631,34.5082],[-119.627,34.5242],[-119.627,34.5262],[-119.631,34.5305],[-119.632,34.5147],[-119.631,34.5205],[-119.629,34.5123],[-119.63,34.5131],[-119.628,34.5273],[-119.63,34.5127],[-119.63,34.5121],[-119.631,34.519],[-119.631,34.5185],[-119.63,34.5111],[-119.633,34.5156],[-119.632,34.5147],[-119.632,34.5147],[-119.63,34.5122],[-119.63,34.5121],[-119.629,34.5291],[-119.629,34.5123],[-119.631,34.5301],[-119.629,34.5213],[-119.631,34.5214],[-119.63,34.5115],[-119.631,34.5091],[-119.629,34.5126],[-119.631,34.5085],[-119.63,34.5112],[-119.631,34.5198],[-119.63,34.5117],[-119.632,34.5186],[-119.63,34.5211],[-119.631,34.5206],[-119.63,34.5112],[-119.63,34.5108],[-119.627,34.5227],[-119.629,34.5273],[-119.629,34.5121],[-119.627,34.5223],[-119.631,34.5089],[-119.632,34.5147],[-119.63,34.5116],[-119.628,34.5272],[-119.631,34.5089],[-119.629,34.5213],[-119.631,34.5201],[-119.628,34.527],[-119.63,34.5303],[-119.627,34.5227],[-119.63,34.5218],[-119.63,34.5121],[-119.631,34.5289],[-119.627,34.5243],[-119.631,34.5293],[-119.633,34.5172],[-119.63,34.5113]];
var species = [2229,2231,2233,2234,2235,2406,2510,1621,1804,2005,2006,1764,2195,2386,2387,2584,2319,1708,1709,1600,2208,1715,1717,2589,2137,1759,1760,1643,1596,2413,1673,1674,1937,2160,2162,2378,2397,1796,1892,1895,1897,2266,1802,1803,2277,1752,2051,2052,1798,1799,1800,1573,2165,2169,2171,2074,2332,2333,2522,2527,1913,1718,1646,1963,1942,1626,2194,1945,2335,2336,2590,1670,1902,1903,1904,2278,1610,2029,2562,1649,1967,2173,2175,1608,2176,1725,1726,1968,2083,2087,2088,2093,1772,2142,2493,1905,1906,2323,1972,2177,2516,1727,2364,1890,1858,1859,1861,1863,1849,2012,2209,1730,1731,1761,1767,1667,1734,2125,1638,2512,1914,1915,1814,2198,1793,2013,2016,1755,2721,2040,1842,1702,1845,2213,2219,2223,2224,2227,2404,1779,1780,2151,1816,1817,2191,1713,2244,2245,1907,2558,1973,1948,2489,2490,2396,2179,2037,2524,2525,2365,1617,1919,1622,1976,1977,1980,1983,1985,1988,2492,2181,2317,2533,2534,2303,2304,2285,2389,1749,1750,1751,2358,2405,2260,1822,2275,2185,2186,2288,2290,2106,2108,2305,2307,1877,1880,1843,1696,1697,1801,2133,1949,1951,1953,1869,1826,1829,2111,1830,2135,1694,2188,1659,1833,2403,2291,2520,1931,1925,1840,2367,2595];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});