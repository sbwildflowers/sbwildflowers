var geolocs = [[-119.611,34.4514],[-119.61,34.4551],[-119.611,34.4553],[-119.612,34.4546],[-119.615,34.4558],[-119.611,34.4496],[-119.612,34.4552],[-119.609,34.4548],[-119.611,34.4523],[-119.611,34.4553],[-119.61,34.4551],[-119.616,34.456],[-119.612,34.4553],[-119.609,34.4549],[-119.611,34.4554],[-119.611,34.4515],[-119.612,34.4546],[-119.611,34.4554],[-119.611,34.452],[-119.612,34.4552],[-119.609,34.4549],[-119.611,34.4522],[-119.61,34.4512],[-119.609,34.4548],[-119.611,34.4541],[-119.612,34.4553],[-119.611,34.4502],[-119.612,34.4552],[-119.61,34.4552],[-119.614,34.4559],[-119.611,34.4489],[-119.61,34.4551],[-119.612,34.4552],[-119.609,34.4549],[-119.611,34.4526],[-119.61,34.4551],[-119.613,34.4558],[-119.611,34.451],[-119.61,34.4552],[-119.611,34.4553],[-119.61,34.4554],[-119.611,34.4507],[-119.611,34.4554],[-119.611,34.4529],[-119.609,34.4551],[-119.611,34.4494],[-119.614,34.4558],[-119.612,34.4555],[-119.608,34.4544],[-119.609,34.4551],[-119.611,34.4518],[-119.611,34.4516],[-119.612,34.4552],[-119.609,34.4551],[-119.612,34.4545],[-119.611,34.4554],[-119.609,34.4549],[-119.613,34.4558],[-119.609,34.4551],[-119.614,34.4559],[-119.609,34.4545],[-119.612,34.4548],[-119.611,34.4552],[-119.609,34.455],[-119.609,34.4549],[-119.61,34.451],[-119.615,34.4558],[-119.611,34.4524],[-119.61,34.4551],[-119.6,34.4557],[-119.61,34.4551],[-119.611,34.4492],[-119.611,34.4552],[-119.612,34.4553],[-119.61,34.4551],[-119.611,34.4509],[-119.61,34.4552],[-119.615,34.4559],[-119.611,34.4525],[-119.609,34.455],[-119.611,34.4554],[-119.611,34.4521],[-119.611,34.4552],[-119.611,34.4526],[-119.611,34.4553],[-119.609,34.4544],[-119.611,34.45],[-119.61,34.455],[-119.611,34.455],[-119.612,34.4541],[-119.609,34.455],[-119.611,34.4511],[-119.615,34.4558],[-119.6,34.4557],[-119.61,34.4551],[-119.611,34.4551],[-119.61,34.4511],[-119.614,34.4558],[-119.612,34.4545],[-119.595,34.4738],[-119.612,34.4549],[-119.609,34.4551],[-119.611,34.4553],[-119.611,34.4502],[-119.612,34.4552],[-119.611,34.4509],[-119.615,34.4556],[-119.609,34.4551],[-119.611,34.4508],[-119.612,34.4548],[-119.615,34.4557],[-119.611,34.4554],[-119.611,34.4508],[-119.611,34.4515],[-119.615,34.4558],[-119.591,34.4634],[-119.61,34.4551],[-119.612,34.4552],[-119.611,34.4522],[-119.615,34.4557],[-119.611,34.4501],[-119.609,34.455],[-119.609,34.4549],[-119.607,34.454],[-119.609,34.4551],[-119.611,34.451],[-119.61,34.4551],[-119.611,34.4491],[-119.609,34.455],[-119.609,34.4549],[-119.609,34.4549],[-119.611,34.4515],[-119.612,34.4552],[-119.615,34.4556],[-119.61,34.4553],[-119.61,34.4552],[-119.611,34.4494],[-119.612,34.4552],[-119.609,34.4544],[-119.609,34.4546],[-119.615,34.4555],[-119.61,34.451],[-119.609,34.4547],[-119.611,34.451],[-119.609,34.4551],[-119.611,34.4519],[-119.608,34.4542],[-119.611,34.4552],[-119.615,34.4554],[-119.611,34.4488],[-119.611,34.4518],[-119.611,34.4502],[-119.615,34.4557],[-119.612,34.455],[-119.61,34.4551],[-119.612,34.4542],[-119.612,34.4552],[-119.611,34.4522],[-119.612,34.4552],[-119.609,34.4549],[-119.616,34.4559],[-119.609,34.4546],[-119.613,34.4556],[-119.611,34.4501],[-119.611,34.4554],[-119.612,34.4546],[-119.609,34.4547],[-119.611,34.4495],[-119.611,34.4554],[-119.612,34.4546],[-119.61,34.4551],[-119.611,34.4555],[-119.611,34.4522],[-119.611,34.455],[-119.612,34.4531],[-119.609,34.4546],[-119.611,34.4497],[-119.611,34.4501],[-119.614,34.4559],[-119.61,34.4549],[-119.612,34.4545],[-119.612,34.4529],[-119.613,34.4558],[-119.609,34.4545],[-119.611,34.4516],[-119.609,34.4549],[-119.61,34.4552],[-119.611,34.4497],[-119.615,34.4556],[-119.611,34.455],[-119.611,34.4551],[-119.608,34.4542],[-119.609,34.4548],[-119.608,34.4542],[-119.611,34.4552],[-119.612,34.4532],[-119.609,34.4552],[-119.611,34.4553],[-119.611,34.4548],[-119.612,34.4538],[-119.611,34.4496],[-119.615,34.4557],[-119.609,34.4551],[-119.611,34.452],[-119.61,34.4551],[-119.611,34.4552],[-119.611,34.452],[-119.609,34.4548],[-119.611,34.4495],[-119.611,34.4551],[-119.612,34.453],[-119.611,34.455],[-119.611,34.4501],[-119.609,34.4549],[-119.611,34.4553],[-119.612,34.4526],[-119.608,34.4545],[-119.611,34.4553],[-119.611,34.4517],[-119.612,34.4549],[-119.61,34.4551],[-119.611,34.4529],[-119.61,34.4551],[-119.612,34.4556],[-119.611,34.45],[-119.611,34.4519],[-119.611,34.4554],[-119.612,34.4549],[-119.611,34.455],[-119.611,34.4553],[-119.611,34.4549],[-119.611,34.4517],[-119.604,34.4557],[-119.61,34.4553],[-119.609,34.4552],[-119.611,34.4514],[-119.61,34.4551],[-119.609,34.4545],[-119.609,34.4549],[-119.615,34.4559],[-119.612,34.4545],[-119.611,34.4552],[-119.612,34.4552],[-119.609,34.4549],[-119.611,34.455],[-119.611,34.4529],[-119.611,34.4511],[-119.61,34.4552]];
var species = [1705,2231,2233,2276,1758,2025,1909,1698,2584,1998,2725,1708,1615,1600,1716,1754,1668,2113,2069,1674,2419,1933,2378,2118,2119,1796,2270,2271,2272,1802,2277,2080,2362,1573,2165,2166,2074,2332,2333,2003,1711,1963,1786,1792,1670,1902,1610,2029,1649,1651,1609,1726,2088,1772,2142,1905,1906,1972,2364,1691,1860,1863,2012,1731,2147,1667,2280,2125,1812,1813,1915,2198,2370,2040,1745,2219,1779,1780,2183,2191,2192,2193,2453,1713,1654,2245,2077,2129,2396,2314,2365,1617,1618,1622,1980,1982,1989,1991,2317,2304,2285,1748,1749,1750,1614,2103,2254,1822,2274,2031,2034,2035,2036,2290,2307,1883,1885,1843,1696,2447,1928,1795,2061,2062,1949,1953,1742,1869,1826,1829,1846,1605,1703,1694,2188,1683,2339,1833,1788,2366,2529];

$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	geolocs.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower',
		        coords: 'hi' 
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	// display popup on click
	map.on('click', function (evt) {
	  var feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {
	    return feature;
	  });
	  console.log($(element));
	  if (feature) {
	    var coordinates = feature.getGeometry().getCoordinates();
	    var lonlat = ol.proj.transform(coordinates, 'EPSG:3857', 'EPSG:4326');
	    console.log(lonlat);
	  }
	});

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());
});