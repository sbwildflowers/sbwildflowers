var subSightings = [[-119.567,34.4788],[-119.611,34.4994],[-119.637,34.495],[-119.56,34.4861],[-119.636,34.493],[-119.567,34.4786],[-119.603,34.4935],[-119.746,34.5845],[-119.602,34.4934],[-119.766,34.5646],[-119.768,34.5641],[-119.634,34.5041],[-119.767,34.5643],[-119.597,34.4936],[-119.754,34.5272],[-119.572,34.4812],[-119.766,34.5648],[-119.762,34.5658],[-120.002,34.7437],[-119.753,34.5044],[-119.762,34.5657],[-119.77,34.5513],[-119.372,34.6162],[-119.614,34.4954],[-119.756,34.5127],[-119.768,34.5639],[-119.611,34.4995],[-119.764,34.6321],[-119.636,34.4951],[-119.925,34.7488],[-119.696,34.5094],[-119.757,34.5095],[-119.636,34.4929],[-119.759,34.5268],[-119.636,34.495],[-119.766,34.631],[-119.514,34.4884],[-119.741,34.5683],[-119.76,34.5664],[-119.755,34.5126],[-119.754,34.5991],[-119.765,34.5649],[-119.755,34.5076],[-119.757,34.5702],[-119.767,34.631],[-119.816,34.5334],[-119.77,34.5451],[-119.674,34.5473],[-119.636,34.4935],[-119.595,34.4929],[-120.007,34.7496],[-119.749,34.5661],[-119.957,34.7612],[-119.597,34.4938],[-119.76,34.5668],[-119.762,34.5662],[-119.636,34.4933],[-119.77,34.5474],[-119.769,34.5501],[-119.632,34.5071],[-119.753,34.5274],[-119.757,34.51],[-119.758,34.5681],[-119.581,34.4904],[-119.746,34.5852],[-119.632,34.5077],[-119.636,34.4953],[-119.749,34.5005],[-119.736,34.55],[-119.726,34.5324],[-119.621,34.5398],[-119.762,34.5661],[-120.002,34.7477],[-119.93,34.7667],[-119.633,34.5076],[-119.967,34.7365],[-119.758,34.5137],[-119.748,34.6126],[-119.352,34.6051],[-119.746,34.4957],[-119.636,34.4928],[-119.757,34.5106],[-119.767,34.5646],[-119.757,34.5687],[-119.769,34.5505],[-119.632,34.5076],[-119.769,34.5513],[-119.769,34.5514],[-119.76,34.5669],[-119.611,34.4999],[-119.696,34.5095],[-119.767,34.63],[-119.769,34.5502],[-119.611,34.4997],[-119.741,34.5684],[-119.758,34.5135],[-119.91,34.7719],[-119.614,34.4955],[-119.602,34.4932],[-119.761,34.566],[-119.749,34.5701],[-119.758,34.5099],[-119.458,34.4923],[-119.609,34.4955],[-119.767,34.5641],[-119.588,34.4916],[-119.76,34.6309],[-119.887,34.775],[-119.772,34.6295],[-119.885,34.7738],[-119.766,34.6299],[-119.636,34.4932],[-119.749,34.5704],[-119.769,34.629],[-119.768,34.5637],[-119.884,34.7735],[-119.611,34.5002],[-119.631,34.5084],[-119.762,34.566],[-119.636,34.4927],[-119.519,34.4889],[-119.785,34.5579],[-119.76,34.5666],[-119.76,34.5667],[-119.757,34.5701],[-119.456,34.4921],[-119.758,34.5134],[-119.545,34.4906],[-119.765,34.5648],[-119.985,34.801],[-119.596,34.4703],[-119.769,34.5503],[-119.643,34.4614],[-119.766,34.5651],[-119.769,34.6294],[-119.785,34.5577],[-119.759,34.5371],[-119.607,34.494],[-119.631,34.5087],[-119.688,34.5191],[-119.748,34.613],[-119.512,34.4883],[-119.571,34.481],[-119.785,34.5578],[-119.759,34.5266],[-119.755,34.5079],[-119.761,34.6301],[-119.634,34.5047],[-119.632,34.5075],[-119.637,34.4949],[-119.603,34.4934],[-119.77,34.5449],[-119.759,34.5677],[-119.636,34.4926],[-119.614,34.4953],[-119.609,34.495],[-119.746,34.4956],[-119.757,34.5141],[-119.372,34.6157],[-119.636,34.511],[-119.609,34.4951],[-119.768,34.5638],[-119.5,34.4742],[-119.686,34.5145],[-119.769,34.5519],[-119.765,34.6325],[-119.751,34.5018],[-119.756,34.5104],[-119.636,34.4948],[-119.745,34.5855],[-119.631,34.5086],[-119.769,34.5628],[-119.757,34.5098],[-119.983,34.7996],[-119.352,34.6049],[-119.769,34.5516],[-119.552,34.4939],[-119.515,34.4889],[-119.766,34.5596],[-119.758,34.51],[-119.632,34.5067],[-119.758,34.568],[-119.757,34.5688],[-119.945,34.772],[-119.611,34.4998],[-119.611,34.4996],[-119.754,34.5772],[-119.762,34.5655],[-119.688,34.5531],[-120.002,34.7478],[-119.634,34.5046],[-119.769,34.5633],[-119.757,34.5686],[-119.77,34.545],[-119.757,34.5097],[-119.759,34.568],[-119.759,34.5674],[-119.598,34.4943],[-119.631,34.5187],[-119.75,34.5005],[-119.755,34.513],[-119.607,34.4943],[-119.687,34.5535],[-119.758,34.5186],[-119.683,34.5536],[-119.633,34.5075],[-119.957,34.7812],[-119.636,34.4934],[-119.631,34.5085],[-119.683,34.4755],[-119.754,34.5997],[-119.756,34.51],[-119.769,34.5634],[-119.758,34.5136],[-119.954,34.7944],[-119.632,34.5072],[-119.758,34.5131],[-119.633,34.5074],[-120.003,34.7432],[-119.77,34.5512],[-119.766,34.5647],[-119.759,34.5267],[-119.75,34.5008],[-119.636,34.4931],[-119.759,34.5671],[-119.515,34.4881],[-119.759,34.567],[-119.682,34.4977],[-119.746,34.5844],[-119.76,34.5259],[-119.749,34.5004],[-119.75,34.5016],[-119.758,34.5682],[-119.496,34.4852],[-119.76,34.5661],[-119.758,34.5139],[-119.771,34.6281],[-119.637,34.4947],[-119.576,34.5131],[-119.745,34.5854],[-119.757,34.5096],[-119.758,34.5184],[-119.757,34.514],[-119.757,34.5099],[-119.754,34.5273],[-119.757,34.5094],[-119.756,34.5103],[-119.633,34.5073],[-119.665,34.5226],[-119.687,34.5532],[-119.609,34.4954],[-119.76,34.5662],[-119.597,34.4939],[-119.244,34.4672],[-119.764,34.5646],[-119.965,34.7545],[-119.25,34.4704],[-119.769,34.5632],[-119.649,34.4581],[-119.636,34.4947],[-119.889,34.7478],[-119.907,34.7983],[-119.76,34.5665],[-119.758,34.5683],[-119.683,34.4754],[-119.769,34.5515],[-119.762,34.5656],[-119.77,34.5459],[-119.757,34.5699],[-119.761,34.5384],[-119.77,34.5516],[-119.757,34.5138],[-119.637,34.4948],[-119.767,34.5642],[-119.754,34.5271],[-119.61,34.4955],[-119.594,34.4916],[-119.928,34.7664],[-119.752,34.5282],[-119.77,34.5514],[-119.746,34.584],[-119.755,34.5081],[-119.609,34.4949],[-119.754,34.5275],[-119.757,34.5101],[-119.759,34.5381],[-119.682,34.4754],[-119.773,34.5583],[-119.762,34.5659],[-119.372,34.616],[-119.634,34.504],[-119.906,34.7649],[-119.77,34.5461],[-119.945,34.7718],[-119.631,34.5089],[-119.609,34.4953],[-119.759,34.5679],[-119.45,34.491],[-119.956,34.7785],[-119.682,34.4747],[-119.99,34.804],[-119.746,34.5843],[-119.632,34.5074],[-119.594,34.4914],[-119.765,34.5646],[-119.757,34.5177],[-119.597,34.4937],[-119.768,34.5642],[-119.496,34.4778],[-119.636,34.4949],[-119.636,34.4946],[-119.746,34.5557],[-119.759,34.5668],[-119.964,34.7552],[-119.746,34.4958],[-119.636,34.4936],[-119.817,34.532],[-119.771,34.5478],[-119.763,34.5655],[-119.765,34.5647],[-119.596,34.4936],[-119.561,34.5],[-119.768,34.564],[-119.755,34.508],[-119.766,34.6305],[-119.755,34.5989],[-119.757,34.5685],[-119.758,34.5679]];
$(document).ready(function() {
	var vectorSource = new ol.source.Vector({
      //create empty vector
    });

	//create a bunch of icons and add to source vector
	subSightings.forEach(function(item,index) {
		var iconFeature = new ol.Feature({
		          geometry: new  
		            ol.geom.Point(ol.proj.fromLonLat(item)),
		        name: 'Flower'
		});
		vectorSource.addFeature(iconFeature);
	});

    //create the style
    var iconStyle = new ol.style.Style({
      image: new ol.style.Icon( ({
        anchor: [0.5, 46],
        anchorXUnits: 'fraction',
        anchorYUnits: 'pixels',
        opacity: 0.75,
        src: '../flower.png'
      }))
    });

    //add the feature vector to the layer vector, and apply a style to whole layer
    var vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: iconStyle
    });

	var attribution = new ol.control.Attribution({
	     collapsible: false
	 });

	 var map = new ol.Map({
	     controls: ol.control.defaults({attribution: false}).extend([attribution]),
	     layers: [
	         new ol.layer.Tile({
	             source: new ol.source.OSM()
	         }),
	         vectorLayer
	     ],
	     target: 'map',
	     view: new ol.View({
	         center: ol.proj.fromLonLat([-119.644, 34.5158]),
	         zoom: 15,
	         maxZoom: 20
	     })
	 });

	$('.sightings-wrapper tbody tr .locate').click(function() {
		$('.sightings-wrapper tr').each(function() {
			$(this).removeClass('active');
		});
		$(this).parent('tr').addClass('active');
		lat = parseFloat($(this).siblings('.lat').text());
		lon = parseFloat($(this).siblings('.lon').text());
        map.getView().animate({
          center: ol.proj.fromLonLat([lon,lat]),
          duration: 2000,
          zoom: 18
        });
        var elmnt = document.getElementById('map-wrapper');
		elmnt.scrollIntoView();
    });

	var extent = vectorLayer.getSource().getExtent();
	map.getView().fit(extent, map.getSize());

	$('.map-wrapper button').click(function() {
		map.getView().fit(extent, map.getSize());
	});
});